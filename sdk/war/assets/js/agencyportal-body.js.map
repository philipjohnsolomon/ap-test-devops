{"version":3,"sources":["../../../Web%20Source/lib/infinite-scroll/jquery.infinitescroll.js","../../../Web%20Source/js/solr/solrbatchupdate.js","../../../Web%20Source/js/ap_turnstile_widget.js","../../../Web%20Source/js/worklist-ng/worklist.app.js","../../../Web%20Source/js/worklist-ng/worklist.srv.js","../../../Web%20Source/js/worklist-ng/worklist.search.ctrl.js","../../../Web%20Source/js/worklist-ng/worklist.data.ctrl.js","../../../Web%20Source/js/worklist-ng/worklist.workitemactions.srv.js","../../../Web%20Source/js/worklist-ng/worklist.workitemdata.drv.js","../../../Web%20Source/js/worklist-ng/worklist.addnewcard.drv.js","../../../Web%20Source/js/worklist-ng/worklist.workitemactions.mdl.js","../../../Web%20Source/js/workitemassistant-ng/workitemassistant.ctrl.js","../../../Web%20Source/js/queues/worklist.recentWorkItemsQueue.ctrl.js"],"names":["window","$","undefined","infinitescroll","options","callback","element","this","_create","failed","defaults","loading","finished","finishedMsg","img","msg","msgText","selector","speed","start","state","isDuringAjax","isInvalidPage","isDestroyed","isDone","isPaused","isBeyondMaxPage","currPage","debug","behavior","binder","nextSelector","navSelector","contentSelector","extraScrollPx","itemSelector","animate","pathParse","dataType","appendCallback","bufferPx","errorCallback","infid","pixelsFromNavToBottom","path","prefill","maxPage","prototype","_binding","binding","instance","opts","v","call","_debug","unbind","scroll","extend","$window","_validate","attr","_determinepath","Image","src","document","height","offset","top","self","hide","appendTo","show","proxy","beginAjax","fadeOut","data","url","bind","_prefill","Function","console","log","forEach","method","_setup","needsPrefill","Array","slice","arguments","length","toString","match","_error","xhr","_showdonemsg","_loadcallback","box","frag","result","find","children","createDocumentFragment","firstChild","appendChild","get","scrollTo","scrollTop","_nearbottom","pixelsFromWindowBottomToBottom","_pausing","pause","parent","html","opacity","key","indexOf","destroy","resume","desturl","condition","is","join","load","responseText","toUpperCase","ajax","complete","jqXHR","textStatus","isResolved","type","success","template","theData","append","error","retrieve","pageNum","toggle","update","isPlainObject","fn","thisCall","args","each","isFunction","charAt","apply","scrollTimeout","event","special","smartscroll","setup","handler","teardown","execAsap","context","clearTimeout","setTimeout","trigger","jQuery","angular","module","controller","$log","$http","csrf","metaData","ap","consoleInfo","message","updateIndex","params","headers","Accept","Content-Type","then","response","responseHeader","status","error_msg","environment","TurnstileWidget","turnstileServiceURL","refreshTimeout","deletePopoverTemplate","core_prompts","deletePopoverTemplateWithGUID","fileDeleteAction","rowTemplate","rowTemplateWithError","tdTemplateWithError","wiListRowTemplate","wiListRowTemplateError","formsHeading","formsNotProcessedHeading","formsNotRecognizedHeading","formsTemplate","fileListRowTemplate","fileUploaderAlertdivTemplate","showStatusAlertdivTemplate","accountMessageTemplate","spinnerSpan","currentAccountId","spinnerOpts","lines","width","radius","corners","rotate","direction","color","trail","shadow","hwaccel","className","zIndex","left","fileUploadData","widgetOpen","launchUploadWidget","accountId","resetFileuploadSection","modal","remove","tab","processStagedUpload","guid","showLobSelector","deleteStagedItem","requestType","always","turnstileWidget","showUploadStatus","renderUploadStatusTableContent","innerHTML","list","val","index","tmp","split","fileName","lastUpdateTime","statusDesc","replace","popover","on","$popup","next","click","e","spinner","Spinner","spin","el","target","has","updateUploadStatusTableContent","previousMessage","$self","dataGuids","button","off","removeAttr","tr","err","isTurnstileEnabled","done","txt","closest","prepend","tmpHtml","formsList","forms","value","errorformsList","notSupportedForms","errorFormsHtml","numErrors","pageCount","file","notRecognizedForms","hasOwnProperty","pages","push","resetLightboxState","processLobSelection","isAccountManagementFeatureOn","addProgressIndicatorSpinner","createWorkItems","removeSpinnerControl","cancelLobSelection","fileuploadControlInitialized","setupFileuploaderControls","fileControl","fileDropZone","fileupload","autoUpload","singleFileUploads","acceptFileTypes","dropZone","maxFileSize","files","tmpRow","tmpClass","name","fileSize","size","Math","round","toFixed","fileRow","deleteRow","tooltip","progress","parseInt","loaded","total","css","prependAertMessage","responseJSON","addClass","preventDefault","removeClass","resetAccountSearchModal","accountSearchmanager","reset","consoleError","startUpload","tsSelectAccount","createWorkItemsWithAccount","ModalAccountSearchManager","hasClass","ix","splice","filter","submit","createWorkItemsAndAccount","resetAccountModal","continueWithoutAccount","action","accId","tranactions","map","transactions","accountid","code","renderWorkitemsList","fail","countWorkItems","workItemCount","workitems","item","countErrors","count","account","lobCd","errorCount","entityName","workitemid","wiId","lobDesc","location","href","reload","config","$provide","$httpProvider","interceptors","$q","$rootScope","responseError","$broadcast","reject","directive","$timeout","securityErrorCodes","restrict","link","scope","attrs","messages","hasSecurityError","$on","eventData","templateUrl","$filter","input","decimals","service","model","workItems","pagination","cleanMetaData","worklist_metaData","account_metaData","lookuplist","$resource","contextPath","csrfObject","urls","WorkItemsView","listId","worklistType","AccountItemsView","AccountsView","worklist","wlResParams","views","csrftokenname","csrftoken","saved_search_id","searchName","worklistResource","getmetadata","isArray","query","save","newWorkItemLinksResource","work_item_type","setCSRFToken","csrftokenValue","csrftokenName","tokenobj","retrieveLookupList","lookupLinks","paramsObj","realmComponentArray","rel","getParameterByName","results","codeList","codes","lookupValue","retVal","option","title","getAdvancedSearch","queryInfoLinks","queryInfo","links","dialogResUrl","getList","sections","fields","field","effDtField","selectedOperator","defaultValue","optionLists","optionlist","optionList","optionEntries","selectedOption","content","pageId","page","saveSearch","resHandler","searNameParam","par","deleteSearch","searchId","getMetaData","workListView","listViews","view","selected","viewPortSize","startRowNumber","fetchSize","getNewWorkItemLinks","performModalSearch","indexType","searchValue","accountIdToExclude","metaDataCopy","copy","searchField","workItemField","queryFields","queryField","relatedFieldId","operands","opCode","docs","searchEntities","getWorkItems","hits","currentPage","wid","newWorkItemLinks","regex","RegExp","exec","search","decodeURIComponent","$routeProvider","when","reloadOnSearch","otherwise","redirectTo","$location","$modal","WorkListViewSrv","dateFormat","workListModel","advancedDropDown","isopen","sortByStatus","isOpen","savedSearchName","currentSearchName","initView","listview","allFilters","filters","equals","filterOptions","filterOption","interactive","fetchWorkItems","workListType","searchNameParam","clearPagination","isSaveable","savedSearchInfo","currentSearch","id","setAdvQueryField","pageField","pageFieldId","startDate","endDate","validateAdvSearch","invalidAdvSearch","advanceSearchClicked","saveSearchClicked","saveError","callBackFn","currSearch","retriveSavedSearch","responseHandler","savedSearch","deleteSavedSearch","open","resolve","getLOBs","lobsArray","getEntityNameModel","selectFilter","object","clearSelected","clearFilters","sortInfo","sortOptions","sortOpt","getSelectedFilters","selectedFilters","getSelectedSorts","selectedSorts","sorts","selectSortOption","sortOption","ascending","getFilterTitle","filterType","filterValue","switchView","selectedView","eachView","fieldName","$event","stopPropagation","WorkItemActionsSrv","getLobDesc","lobIdx","initiateUpload","isWorkItemSelected","workitem","isLinkedToAccount","account_id","getWorkItemActions","actions","work_item_id","res","itemSelected","selectedWorkItem","isAccountsView","isWorkItemsView","isAccountItemsView","deleteWorkItem","modalInstance","details","isAccount","plsWaitModal","keyboard","backdrop","executeAction","dismiss","info","Date","doApprove","doLinkToAccount","selectedAccount","doMoveToAccount","pageChanged","performAction","param","endorseTransactionId","newWorkItemId","openMode","openAction","openUrl","performCustomAction","createWorkItem","newVal","format","filtersToApply","formatVal","tokens","i","trim","getTableColumns","listField","sortField","isSortable","toggleSort","getSortDirection","performDoubleClick","workitemId","successCallBack","errorCallBack","WORKITEMID","workitemData","whenSelected","whenActionClicked","contentUrl","actionsOpen","$observe","callbackFunction","actionClicked","isWorkItemSubmitted","external_id","addlinks","whenUpload","addNewState","setState","$scope","$modalInstance","yes","close","no","accounts","searchVal","showSearchAccounts","displayResults","select","createNewAccount","lookupAccounts","successMessage","htmlDecode","workitemAssistantModule","ModalService","showWorkitemAssistant","comments","fileattachments","activeusers","filetypes","editInProgress","commentInputs","transaction","workItemId","CSRF_TOKEN","csrfToken","transaction_id","rnd","getTime","workItemAssistant","updateData","entry","fileTypes","poll","clientUpdateInterval","commentsEmpty","section","addComment","commentText","getBaseUri","getCommonUrlParams","deleteEntry","showModal","inputs","entryId","sectionType","sectionId","editEntry","error_callback","FileUploader","fileTypeCode","uploader","removeAfterUpload","queueLimit","_addToQueue","addToQueue","onBeforeUploadItem","formData","PAGE_NAME","TRANSACTION_NAME","METHOD","NEXT","ACTION","SECTION","FILE_TYPE","onCompleteItem","clearQueue","hasFileCodeSelected","showQueue","isHTML5","showAction","sendAll","getNotUploadedItems","uploadAll","clearAll","queue","isUploading","cancel","_destroy","_getTotalProgress","filename","filenNameEmpty","arg","file_name","WI_ASSISTANT_ID","commentId","agentqueue","uwqueue","quoteBoxes","fetchWorkItem","read","getItemCount","statuses","items","getQuoteGroups","getDaysFromToday","lastUpdated","nowTime","pattern","dt","substring","lastDatetime","diff","secs","abs","quene","keepGoing","getQuoteCount","getWorkItemValue","last_update_time"],"mappings":"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","file":"agencyportal-body.js","sourceRoot":"../","sourcesContent":["/*jshint undef: true */\n/*global jQuery: true */\n\n/*\n   --------------------------------\n   Infinite Scroll\n   --------------------------------\n   + https://github.com/paulirish/infinite-scroll\n   + version 2.0b2.120519\n   + Copyright 2011/12 Paul Irish & Luke Shumard\n   + Licensed under the MIT license\n\n   + Documentation: http://infinite-scroll.com/\n*/\n\n(function (window, $, undefined) {\n\t\"use strict\";\n\n    $.infinitescroll = function infscr(options, callback, element) {\n        this.element = $(element);\n\n        // Flag the object in the event of a failed creation\n        if (!this._create(options, callback)) {\n            this.failed = true;\n        }\n    };\n\n    $.infinitescroll.defaults = {\n        loading: {\n            finished: undefined,\n            finishedMsg: \"<em>Congratulations, you've reached the end of the internet.</em>\",\n\t\t\timg: \"data:image/gif;base64,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\",\n            msg: null,\n            msgText: \"<em>Loading the next set of posts...</em>\",\n            selector: null,\n            speed: 'fast',\n            start: undefined\n        },\n        state: {\n            isDuringAjax: false,\n            isInvalidPage: false,\n            isDestroyed: false,\n            isDone: false, // For when it goes all the way through the archive.\n            isPaused: false,\n            isBeyondMaxPage: false,\n            currPage: 1\n        },\n        debug: false,\n\t\tbehavior: undefined,\n        binder: $(window), // used to cache the selector\n        nextSelector: \"div.navigation a:first\",\n        navSelector: \"div.navigation\",\n        contentSelector: null, // rename to pageFragment\n        extraScrollPx: 150,\n        itemSelector: \"div.post\",\n        animate: false,\n        pathParse: undefined,\n        dataType: 'html',\n        appendCallback: true,\n        bufferPx: 40,\n        errorCallback: function () { },\n        infid: 0, //Instance ID\n        pixelsFromNavToBottom: undefined,\n        path: undefined, // Either parts of a URL as an array (e.g. [\"/page/\", \"/\"] or a function that takes in the page number and returns a URL\n\t\tprefill: false, // When the document is smaller than the window, load data until the document is larger or links are exhausted\n        maxPage: undefined // to manually control maximum page (when maxPage is undefined, maximum page limitation is not work)\n\t};\n\n    $.infinitescroll.prototype = {\n\n        /*\t\n            ----------------------------\n            Private methods\n            ----------------------------\n            */\n\n        // Bind or unbind from scroll\n        _binding: function infscr_binding(binding) {\n\n            var instance = this,\n            opts = instance.options;\n\n            opts.v = '2.0b2.120520';\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['_binding_'+opts.behavior] !== undefined) {\n                this['_binding_'+opts.behavior].call(this);\n                return;\n            }\n\n            if (binding !== 'bind' && binding !== 'unbind') {\n                this._debug('Binding value  ' + binding + ' not valid');\n                return false;\n            }\n\n            if (binding === 'unbind') {\n                (this.options.binder).unbind('smartscroll.infscr.' + instance.options.infid);\n            } else {\n                (this.options.binder)[binding]('smartscroll.infscr.' + instance.options.infid, function () {\n                    instance.scroll();\n                });\n            }\n\n            this._debug('Binding', binding);\n        },\n\n        // Fundamental aspects of the plugin are initialized\n        _create: function infscr_create(options, callback) {\n\n            // Add custom options to defaults\n            var opts = $.extend(true, {}, $.infinitescroll.defaults, options);\n\t\t\tthis.options = opts;\n\t\t\tvar $window = $(window);\n\t\t\tvar instance = this;\n\n\t\t\t// Validate selectors\n            if (!instance._validate(options)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n            // Validate page fragment path\n            var path = $(opts.nextSelector).attr('href');\n            if (!path) {\n                this._debug('Navigation selector not found');\n                return false;\n            }\n\n            // Set the path to be a relative URL from root.\n            opts.path = opts.path || this._determinepath(path);\n\n            // contentSelector is 'page fragment' option for .load() / .ajax() calls\n            opts.contentSelector = opts.contentSelector || this.element;\n\n            // loading.selector - if we want to place the load message in a specific selector, defaulted to the contentSelector\n            opts.loading.selector = opts.loading.selector || opts.contentSelector;\n\n            // Define loading.msg\n            opts.loading.msg = opts.loading.msg || $('<div id=\"infscr-loading\"><img alt=\"Loading...\" src=\"' + opts.loading.img + '\" /><div>' + opts.loading.msgText + '</div></div>');\n\n            // Preload loading.img\n            (new Image()).src = opts.loading.img;\n\n            // distance from nav links to bottom\n            // computed as: height of the document + top offset of container - top offset of nav link\n            if(opts.pixelsFromNavToBottom === undefined) {\n\t\t\t\topts.pixelsFromNavToBottom = $(document).height() - $(opts.navSelector).offset().top;\n\t\t\t\tthis._debug(\"pixelsFromNavToBottom: \" + opts.pixelsFromNavToBottom);\n\t\t\t}\n\n\t\t\tvar self = this;\n\n            // determine loading.start actions\n            opts.loading.start = opts.loading.start || function() {\n                $(opts.navSelector).hide();\n                opts.loading.msg\n                .appendTo(opts.loading.selector)\n                .show(opts.loading.speed, $.proxy(function() {\n\t\t\t\t\tthis.beginAjax(opts);\n\t\t\t\t}, self));\n            };\n\n            // determine loading.finished actions\n            opts.loading.finished = opts.loading.finished || function() {\n                if (!opts.state.isBeyondMaxPage)\n                    opts.loading.msg.fadeOut(opts.loading.speed);\n            };\n\n\t\t\t// callback loading\n            opts.callback = function(instance, data, url) {\n                if (!!opts.behavior && instance['_callback_'+opts.behavior] !== undefined) {\n                    instance['_callback_'+opts.behavior].call($(opts.contentSelector)[0], data, url);\n                }\n\n                if (callback) {\n                    callback.call($(opts.contentSelector)[0], data, opts, url);\n                }\n\n\t\t\t\tif (opts.prefill) {\n\t\t\t\t\t$window.bind(\"resize.infinite-scroll\", instance._prefill);\n\t\t\t\t}\n            };\n\n\t\t\tif (options.debug) {\n\t\t\t\t// Tell IE9 to use its built-in console\n\t\t\t\tif (Function.prototype.bind && (typeof console === 'object' || typeof console === 'function') && typeof console.log === \"object\") {\n\t\t\t\t\t[\"log\",\"info\",\"warn\",\"error\",\"assert\",\"dir\",\"clear\",\"profile\",\"profileEnd\"]\n\t\t\t\t\t\t.forEach(function (method) {\n\t\t\t\t\t\t\tconsole[method] = this.call(console[method], console);\n\t\t\t\t\t\t}, Function.prototype.bind);\n\t\t\t\t}\n\t\t\t}\n\n            this._setup();\n\n\t\t\t// Setups the prefill method for use\n\t\t\tif (opts.prefill) {\n\t\t\t\tthis._prefill();\n\t\t\t}\n\n            // Return true to indicate successful creation\n            return true;\n        },\n\n\t\t_prefill: function infscr_prefill() {\n\t\t\tvar instance = this;\n\t\t\tvar $window = $(window);\n\n\t\t\tfunction needsPrefill() {\n\t\t\t\treturn (instance.options.contentSelector.height() <= $window.height());\n\t\t\t}\n\n\t\t\tthis._prefill = function() {\n\t\t\t\tif (needsPrefill()) {\n\t\t\t\t\tinstance.scroll();\n\t\t\t\t}\n\n\t\t\t\t$window.bind(\"resize.infinite-scroll\", function() {\n\t\t\t\t\tif (needsPrefill()) {\n\t\t\t\t\t\t$window.unbind(\"resize.infinite-scroll\");\n\t\t\t\t\t\tinstance.scroll();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t// Call self after setting up the new function\n\t\t\tthis._prefill();\n\t\t},\n\n        // Console log wrapper\n        _debug: function infscr_debug() {\n\t\t\tif (true !== this.options.debug) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (typeof console !== 'undefined' && typeof console.log === 'function') {\n\t\t\t\t// Modern browsers\n\t\t\t\t// Single argument, which is a string\n\t\t\t\tif ((Array.prototype.slice.call(arguments)).length === 1 && typeof Array.prototype.slice.call(arguments)[0] === 'string') {\n\t\t\t\t\tconsole.log( (Array.prototype.slice.call(arguments)).toString() );\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log( Array.prototype.slice.call(arguments) );\n\t\t\t\t}\n\t\t\t} else if (!Function.prototype.bind && typeof console !== 'undefined' && typeof console.log === 'object') {\n\t\t\t\t// IE8\n\t\t\t\tFunction.prototype.call.call(console.log, console, Array.prototype.slice.call(arguments));\n\t\t\t}\n        },\n\n        // find the number to increment in the path.\n        _determinepath: function infscr_determinepath(path) {\n\n            var opts = this.options;\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['_determinepath_'+opts.behavior] !== undefined) {\n                return this['_determinepath_'+opts.behavior].call(this,path);\n            }\n\n            if (!!opts.pathParse) {\n\n                this._debug('pathParse manual');\n                return opts.pathParse(path, this.options.state.currPage+1);\n\n            } else if (path.match(/^(.*?)\\b2\\b(.*?$)/)) {\n                path = path.match(/^(.*?)\\b2\\b(.*?$)/).slice(1);\n\n                // if there is any 2 in the url at all.    \n            } else if (path.match(/^(.*?)2(.*?$)/)) {\n\n                // page= is used in django:\n                // http://www.infinite-scroll.com/changelog/comment-page-1/#comment-127\n                if (path.match(/^(.*?page=)2(\\/.*|$)/)) {\n                    path = path.match(/^(.*?page=)2(\\/.*|$)/).slice(1);\n                    return path;\n                }\n\n                path = path.match(/^(.*?)2(.*?$)/).slice(1);\n\n            } else {\n\n                // page= is used in drupal too but second page is page=1 not page=2:\n                // thx Jerod Fritz, vladikoff\n                if (path.match(/^(.*?page=)1(\\/.*|$)/)) {\n                    path = path.match(/^(.*?page=)1(\\/.*|$)/).slice(1);\n                    return path;\n                } else {\n                    this._debug('Sorry, we couldn\\'t parse your Next (Previous Posts) URL. Verify your the css selector points to the correct A tag. If you still get this error: yell, scream, and kindly ask for help at infinite-scroll.com.');\n                    // Get rid of isInvalidPage to allow permalink to state\n                    opts.state.isInvalidPage = true;  //prevent it from running on this page.\n                }\n            }\n            this._debug('determinePath', path);\n            return path;\n\n        },\n\n        // Custom error\n        _error: function infscr_error(xhr) {\n\n            var opts = this.options;\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['_error_'+opts.behavior] !== undefined) {\n                this['_error_'+opts.behavior].call(this,xhr);\n                return;\n            }\n\n            if (xhr !== 'destroy' && xhr !== 'end') {\n                xhr = 'unknown';\n            }\n\n            this._debug('Error', xhr);\n\n            if (xhr === 'end' || opts.state.isBeyondMaxPage) {\n                this._showdonemsg();\n            }\n\n            opts.state.isDone = true;\n            opts.state.currPage = 1; // if you need to go back to this instance\n            opts.state.isPaused = false;\n            opts.state.isBeyondMaxPage = false;\n            this._binding('unbind');\n\n        },\n\n        // Load Callback\n        _loadcallback: function infscr_loadcallback(box, data, url) {\n            var opts = this.options,\n            callback = this.options.callback, // GLOBAL OBJECT FOR CALLBACK\n            result = (opts.state.isDone) ? 'done' : (!opts.appendCallback) ? 'no-append' : 'append',\n            frag;\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['_loadcallback_'+opts.behavior] !== undefined) {\n                this['_loadcallback_'+opts.behavior].call(this,box,data);\n                return;\n            }\n\n\t\t\tswitch (result) {\n\t\t\t\tcase 'done':\n\t\t\t\t\tthis._showdonemsg();\n\t\t\t\t\treturn false;\n\n\t\t\t\tcase 'no-append':\n\t\t\t\t\tif (opts.dataType === 'html') {\n\t\t\t\t\t\tdata = '<div>' + data + '</div>';\n\t\t\t\t\t\tdata = $(data).find(opts.itemSelector);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'append':\n\t\t\t\t\tvar children = box.children();\n\t\t\t\t\t// if it didn't return anything\n\t\t\t\t\tif (children.length === 0) {\n\t\t\t\t\t\treturn this._error('end');\n\t\t\t\t\t}\n\n\t\t\t\t\t// use a documentFragment because it works when content is going into a table or UL\n\t\t\t\t\tfrag = document.createDocumentFragment();\n\t\t\t\t\twhile (box[0].firstChild) {\n\t\t\t\t\t\tfrag.appendChild(box[0].firstChild);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._debug('contentSelector', $(opts.contentSelector)[0]);\n\t\t\t\t\t$(opts.contentSelector)[0].appendChild(frag);\n\t\t\t\t\t// previously, we would pass in the new DOM element as context for the callback\n\t\t\t\t\t// however we're now using a documentfragment, which doesn't have parents or children,\n\t\t\t\t\t// so the context is the contentContainer guy, and we pass in an array\n\t\t\t\t\t// of the elements collected as the first argument.\n\n\t\t\t\t\tdata = children.get();\n\t\t\t\t\tbreak;\n\t\t\t}\n\n            // loadingEnd function\n            opts.loading.finished.call($(opts.contentSelector)[0],opts);\n\n            // smooth scroll to ease in the new content\n            if (opts.animate) {\n                var scrollTo = $(window).scrollTop() + $(opts.loading.msg).height() + opts.extraScrollPx + 'px';\n                $('html,body').animate({ scrollTop: scrollTo }, 800, function () { opts.state.isDuringAjax = false; });\n            }\n\n            if (!opts.animate) {\n\t\t\t\t// once the call is done, we can allow it again.\n\t\t\t\topts.state.isDuringAjax = false;\n\t\t\t}\n\n            callback(this, data, url);\n\n\t\t\tif (opts.prefill) {\n\t\t\t\tthis._prefill();\n\t\t\t}\n\t\t},\n\n        _nearbottom: function infscr_nearbottom() {\n\n            var opts = this.options,\n            pixelsFromWindowBottomToBottom = 0 + $(document).height() - (opts.binder.scrollTop()) - $(window).height();\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['_nearbottom_'+opts.behavior] !== undefined) {\n                return this['_nearbottom_'+opts.behavior].call(this);\n            }\n\n            this._debug('math:', pixelsFromWindowBottomToBottom, opts.pixelsFromNavToBottom);\n\n            // if distance remaining in the scroll (including buffer) is less than the orignal nav to bottom....\n            return (pixelsFromWindowBottomToBottom - opts.bufferPx < opts.pixelsFromNavToBottom);\n\n        },\n\n        // Pause / temporarily disable plugin from firing\n        _pausing: function infscr_pausing(pause) {\n\n            var opts = this.options;\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['_pausing_'+opts.behavior] !== undefined) {\n                this['_pausing_'+opts.behavior].call(this,pause);\n                return;\n            }\n\n            // If pause is not 'pause' or 'resume', toggle it's value\n            if (pause !== 'pause' && pause !== 'resume' && pause !== null) {\n                this._debug('Invalid argument. Toggling pause value instead');\n            }\n\n            pause = (pause && (pause === 'pause' || pause === 'resume')) ? pause : 'toggle';\n\n            switch (pause) {\n                case 'pause':\n                    opts.state.isPaused = true;\n                break;\n\n                case 'resume':\n                    opts.state.isPaused = false;\n                break;\n\n                case 'toggle':\n                    opts.state.isPaused = !opts.state.isPaused;\n                break;\n            }\n\n            this._debug('Paused', opts.state.isPaused);\n            return false;\n\n        },\n\n        // Behavior is determined\n        // If the behavior option is undefined, it will set to default and bind to scroll\n        _setup: function infscr_setup() {\n\n            var opts = this.options;\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['_setup_'+opts.behavior] !== undefined) {\n                this['_setup_'+opts.behavior].call(this);\n                return;\n            }\n\n            this._binding('bind');\n\n            return false;\n\n        },\n\n        // Show done message\n        _showdonemsg: function infscr_showdonemsg() {\n\n            var opts = this.options;\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['_showdonemsg_'+opts.behavior] !== undefined) {\n                this['_showdonemsg_'+opts.behavior].call(this);\n                return;\n            }\n\n            opts.loading.msg\n            .find('img')\n            .hide()\n            .parent()\n            .find('div').html(opts.loading.finishedMsg).animate({ opacity: 1 }, 2000, function () {\n                $(this).parent().fadeOut(opts.loading.speed);\n            });\n\n            // user provided callback when done    \n            opts.errorCallback.call($(opts.contentSelector)[0],'done');\n        },\n\n        // grab each selector option and see if any fail\n        _validate: function infscr_validate(opts) {\n            for (var key in opts) {\n                if (key.indexOf && key.indexOf('Selector') > -1 && $(opts[key]).length === 0) {\n                    this._debug('Your ' + key + ' found no elements.');\n                    return false;\n                }\n            }\n\n            return true;\n        },\n\n        /*\t\n            ----------------------------\n            Public methods\n            ----------------------------\n            */\n\n        // Bind to scroll\n        bind: function infscr_bind() {\n            this._binding('bind');\n        },\n\n        // Destroy current instance of plugin\n        destroy: function infscr_destroy() {\n            this.options.state.isDestroyed = true;\n\t\t\tthis.options.loading.finished();\n            return this._error('destroy');\n        },\n\n        // Set pause value to false\n        pause: function infscr_pause() {\n            this._pausing('pause');\n        },\n\n        // Set pause value to false\n        resume: function infscr_resume() {\n            this._pausing('resume');\n        },\n\n\t\tbeginAjax: function infscr_ajax(opts) {\n\t\t\tvar instance = this,\n\t\t\t\tpath = opts.path,\n\t\t\t\tbox, desturl, method, condition;\n\n\t\t\t// increment the URL bit. e.g. /page/3/\n\t\t\topts.state.currPage++;\n\n            // Manually control maximum page \n            if ( opts.maxPage != undefined && opts.state.currPage > opts.maxPage ){\n                opts.state.isBeyondMaxPage = true;\n                this.destroy();\n                return;\n            }\n\n\t\t\t// if we're dealing with a table we can't use DIVs\n\t\t\tbox = $(opts.contentSelector).is('table, tbody') ? $('<tbody/>') : $('<div/>');\n\n\t\t\tdesturl = (typeof path === 'function') ? path(opts.state.currPage) : path.join(opts.state.currPage);\n\t\t\tinstance._debug('heading into ajax', desturl);\n\n\t\t\tmethod = (opts.dataType === 'html' || opts.dataType === 'json' ) ? opts.dataType : 'html+callback';\n\t\t\tif (opts.appendCallback && opts.dataType === 'html') {\n\t\t\t\tmethod += '+callback';\n\t\t\t}\n\n\t\t\tswitch (method) {\n\t\t\t\tcase 'html+callback':\n\t\t\t\t\tinstance._debug('Using HTML via .load() method');\n\t\t\t\t\tbox.load(desturl + ' ' + opts.itemSelector, undefined, function infscr_ajax_callback(responseText) {\n\t\t\t\t\t\tinstance._loadcallback(box, responseText, desturl);\n\t\t\t\t\t});\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'html':\n\t\t\t\t\tinstance._debug('Using ' + (method.toUpperCase()) + ' via $.ajax() method');\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t// params\n\t\t\t\t\t\turl: desturl,\n\t\t\t\t\t\tdataType: opts.dataType,\n\t\t\t\t\t\tcomplete: function infscr_ajax_callback(jqXHR, textStatus) {\n\t\t\t\t\t\t\tcondition = (typeof (jqXHR.isResolved) !== 'undefined') ? (jqXHR.isResolved()) : (textStatus === \"success\" || textStatus === \"notmodified\");\n\t\t\t\t\t\t\tif (condition) {\n\t\t\t\t\t\t\t\tinstance._loadcallback(box, jqXHR.responseText, desturl);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tinstance._error('end');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'json':\n\t\t\t\t\tinstance._debug('Using ' + (method.toUpperCase()) + ' via $.ajax() method');\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\ttype: 'GET',\n\t\t\t\t\t\turl: desturl,\n\t\t\t\t\t\tsuccess: function (data, textStatus, jqXHR) {\n\t\t\t\t\t\t\tcondition = (typeof (jqXHR.isResolved) !== 'undefined') ? (jqXHR.isResolved()) : (textStatus === \"success\" || textStatus === \"notmodified\");\n\t\t\t\t\t\t\tif (opts.appendCallback) {\n\t\t\t\t\t\t\t\t// if appendCallback is true, you must defined template in options.\n\t\t\t\t\t\t\t\t// note that data passed into _loadcallback is already an html (after processed in opts.template(data)).\n\t\t\t\t\t\t\t\tif (opts.template !== undefined) {\n\t\t\t\t\t\t\t\t\tvar theData = opts.template(data);\n\t\t\t\t\t\t\t\t\tbox.append(theData);\n\t\t\t\t\t\t\t\t\tif (condition) {\n\t\t\t\t\t\t\t\t\t\tinstance._loadcallback(box, theData);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tinstance._error('end');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tinstance._debug(\"template must be defined.\");\n\t\t\t\t\t\t\t\t\tinstance._error('end');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// if appendCallback is false, we will pass in the JSON object. you should handle it yourself in your callback.\n\t\t\t\t\t\t\t\tif (condition) {\n\t\t\t\t\t\t\t\t\tinstance._loadcallback(box, data, desturl);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tinstance._error('end');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\terror: function() {\n\t\t\t\t\t\t\tinstance._debug(\"JSON ajax request failed.\");\n\t\t\t\t\t\t\tinstance._error('end');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\n        // Retrieve next set of content items\n        retrieve: function infscr_retrieve(pageNum) {\n\t\t\tpageNum = pageNum || null;\n\n\t\t\tvar instance = this,\n            opts = instance.options;\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['retrieve_'+opts.behavior] !== undefined) {\n                this['retrieve_'+opts.behavior].call(this,pageNum);\n                return;\n            }\n\n            // for manual triggers, if destroyed, get out of here\n            if (opts.state.isDestroyed) {\n                this._debug('Instance is destroyed');\n                return false;\n            }\n\n            // we dont want to fire the ajax multiple times\n            opts.state.isDuringAjax = true;\n\n            opts.loading.start.call($(opts.contentSelector)[0],opts);\n        },\n\n        // Check to see next page is needed\n        scroll: function infscr_scroll() {\n\n            var opts = this.options,\n            state = opts.state;\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['scroll_'+opts.behavior] !== undefined) {\n                this['scroll_'+opts.behavior].call(this);\n                return;\n            }\n\n            if (state.isDuringAjax || state.isInvalidPage || state.isDone || state.isDestroyed || state.isPaused) {\n\t\t\t\treturn;\n\t\t\t}\n\n            if (!this._nearbottom()) {\n\t\t\t\treturn;\n\t\t\t}\n\n            this.retrieve();\n\n        },\n\n        // Toggle pause value\n        toggle: function infscr_toggle() {\n            this._pausing();\n        },\n\n        // Unbind from scroll\n        unbind: function infscr_unbind() {\n            this._binding('unbind');\n        },\n\n        // update options\n        update: function infscr_options(key) {\n            if ($.isPlainObject(key)) {\n                this.options = $.extend(true,this.options,key);\n            }\n        }\n    };\n\n\n    /*\t\n        ----------------------------\n        Infinite Scroll function\n        ----------------------------\n\n        Borrowed logic from the following...\n\n        jQuery UI\n        - https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.widget.js\n\n        jCarousel\n        - https://github.com/jsor/jcarousel/blob/master/lib/jquery.jcarousel.js\n\n        Masonry\n        - https://github.com/desandro/masonry/blob/master/jquery.masonry.js\t\t\n\n*/\n\n    $.fn.infinitescroll = function infscr_init(options, callback) {\n\n\n        var thisCall = typeof options;\n\n        switch (thisCall) {\n\n            // method \n            case 'string':\n                var args = Array.prototype.slice.call(arguments, 1);\n\n\t\t\t\tthis.each(function () {\n\t\t\t\t\tvar instance = $.data(this, 'infinitescroll');\n\n\t\t\t\t\tif (!instance) {\n\t\t\t\t\t\t// not setup yet\n\t\t\t\t\t\t// return $.error('Method ' + options + ' cannot be called until Infinite Scroll is setup');\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!$.isFunction(instance[options]) || options.charAt(0) === \"_\") {\n\t\t\t\t\t\t// return $.error('No such method ' + options + ' for Infinite Scroll');\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\t// no errors!\n\t\t\t\t\tinstance[options].apply(instance, args);\n\t\t\t\t});\n\n            break;\n\n            // creation \n            case 'object':\n\n                this.each(function () {\n\n                var instance = $.data(this, 'infinitescroll');\n\n                if (instance) {\n\n                    // update options of current instance\n                    instance.update(options);\n\n                } else {\n\n                    // initialize new instance\n                    instance = new $.infinitescroll(options, callback, this);\n\n                    // don't attach if instantiation failed\n                    if (!instance.failed) {\n                        $.data(this, 'infinitescroll', instance);\n                    }\n\n                }\n\n            });\n\n            break;\n\n        }\n\n        return this;\n    };\n\n\n\n    /* \n     * smartscroll: debounced scroll event for jQuery *\n     * https://github.com/lukeshumard/smartscroll\n     * Based on smartresize by @louis_remi: https://github.com/lrbabe/jquery.smartresize.js *\n     * Copyright 2011 Louis-Remi & Luke Shumard * Licensed under the MIT license. *\n     */\n\n    var event = $.event,\n    scrollTimeout;\n\n    event.special.smartscroll = {\n        setup: function () {\n            $(this).bind(\"scroll\", event.special.smartscroll.handler);\n        },\n        teardown: function () {\n            $(this).unbind(\"scroll\", event.special.smartscroll.handler);\n        },\n        handler: function (event, execAsap) {\n            // Save the context\n            var context = this,\n            args = arguments;\n\n            // set correct event type\n            event.type = \"smartscroll\";\n\n            if (scrollTimeout) { clearTimeout(scrollTimeout); }\n            scrollTimeout = setTimeout(function () {\n                $(context).trigger('smartscroll', args);\n            }, execAsap === \"execAsap\" ? 0 : 100);\n        }\n    };\n\n    $.fn.smartscroll = function (fn) {\n        return fn ? this.bind(\"smartscroll\", fn) : this.trigger(\"smartscroll\", [\"execAsap\"]);\n    };\n\n\n})(window, jQuery);\n","(function() {\n\n\t'use strict';\n\n\tangular.module('ap.solrbatchupdater', ['ap.common.constants'])\n\t.controller('ap.solrbatchupdater.SolrBatchUpdater', ['$log','$http', 'csrf','metaData', function($log, $http, csrf, metaData) {\n\t\tap.consoleInfo(\"Initialized Solr batch indexer\");\n\t\tvar self = this;\n\t\tself.metaData = metaData;\n\t\tself.message = \"\";\n\t\tself.error = false;\n\t\tself.success = false;\n\t\t\n\t\tself.updateIndex = function(type){\n\t\t\tself.error = false;\n\t\t\tself.success = false;\n\n\t\t\t$http({\n\t\t        url: 'SolrBatchUpdate?type=' + type,\n\t\t        method: \"POST\",\n\t\t        params: csrf,\n\t\t        headers: { Accept: 'application/json', 'Content-Type': 'application/json' }\n\t\t    })\n\t\t    .then(function(response) {\n\t\t    \tap.consoleInfo(response);\n\t\t    \tif(response.data.responseHeader.status == 0) {\n\t\t    \t\tself.success = true;\n\t\t    \t}else{\n\t\t\t    \tself.message = response.data.error_msg;\n\t\t\t    \tself.error = true;\n\t\t    \t}\n\t\t    });\n\t\t}\n\t\t\n\t}]);\n\t\n})();","\r\n\r\nvar ap = ap || {};\r\nap.environment = ap.environment || {}; // Global environment variable store.\r\n\r\n/**\r\n * Agencyport Turnstile widget manager.  \r\n */\r\nap.TurnstileWidget = function () {\r\n\r\n    \"use strict\";\r\n\t/**\r\n\t* Service URL for Turnstile file upload.\r\n\t*/\r\n    var turnstileServiceURL = \"FileUploadServlet\";\r\n    \r\n    /**\r\n     * time interval for seeking new updates from server while there are queued items in the list\r\n     */\r\n    this.refreshTimeout = 3000;\r\n    \r\n    /**\r\n     * Delete pop over template.\r\n     */\r\n    var deletePopoverTemplate = \"<p>\" + ap.core_prompts[\"action.DeleteConfirmQuestion\"] + \"</p> \" +\r\n\t\"<div class='btn-group'>\" + \r\n\t\t\"<button type='button' class='btn btn-primary ok' >\" +ap.core_prompts[\"action.Yes\"] + \"</button>\" + \r\n\t\t\"<button type='button' class='btn btn-default cancel' >\" +ap.core_prompts[\"action.No\"] + \"</button>\" + \r\n\t\"</div>\";\r\n\r\n    var deletePopoverTemplateWithGUID = \"<p>\" + ap.core_prompts[\"action.DeleteConfirmQuestion\"] + \"</p> \" +\r\n\t\"<div class='btn-group'>\" + \r\n\t\t\"<button type='button' class='btn btn-primary ok' id='{{BGUID}}'>\" +ap.core_prompts[\"action.Yes\"] + \"</button>\" + \r\n\t\t\"<button type='button' class='btn btn-default cancel' >\" +ap.core_prompts[\"action.No\"] + \"</button>\" + \r\n\t\"</div>\";\r\n    /**\r\n     * File Delete button, click on this will trigger a confirmation pop over to be displayed.\r\n     */\r\n    var fileDeleteAction = '<button type=\"button\" class=\"btn btn-default delete-popover\"  data-toggle=\"popover\" data-placement=\"left\" data-html=\"true\" ' +\r\n    \t\t\t\t\t\t'data-content=\"' + deletePopoverTemplate + '\">' + ap.core_prompts[\"action.Delete\"] + '</button>';\r\n    \r\n    \r\n    /**\r\n     * Table Row template for files .\r\n     */\r\n    var rowTemplate = '<tr data-guid={{GUID}} ><td class=\"file-column\">{{formName}}</td><td class=\"date-column\">{{lastUpdated}}</td>' +\r\n        '<td class=\"status-column\"> <button type=\"button\" class=\"btn btn-primary\" {{disabled}} data-dismiss=\"modal\" > <span  class=\"pull-left status-descr\" >{{status}}</span>{{spinner-container}}</button></td>' +\r\n        '<td> <button type=\"button\" class=\"close\" aria-hidden=\"true\"   data-toggle=\"popover\" data-placement=\"left\" data-html=\"true\" ' +\r\n        '\t\t\tdata-content=\"' + deletePopoverTemplateWithGUID + '\"><i class=\"fa\"></i></button></td></tr>';\r\n    \r\n    \r\n    /**\r\n     * Table Row template for files with error.\r\n     */\r\n    var rowTemplateWithError = '<tr data-guid={{GUID}} ><td>{{formName}}</td><td>{{lastUpdated}}</td>' +\r\n        '<td> <button type=\"button\" class=\"btn btn-primary error-close\"  aria-hidden=\"true\"   data-toggle=\"popover\" data-placement=\"{{popovertype}}\" data-html=\"true\" ' +\r\n        '\t\t\tdata-content=\"{{error_message}}\"><span  class=\"pull-left status-descr\" >{{status}}</span></button></td>' +\r\n        '<td> <button type=\"button\" class=\"close\" aria-hidden=\"true\"   data-toggle=\"popover\" data-placement=\"left\" data-html=\"true\" ' +\r\n        '\t\t\tdata-content=\"' + deletePopoverTemplateWithGUID + '\"><i class=\"fa\"></i></button></td></tr>';\r\n   \r\n    /**\r\n     * Table Row template for files with error.\r\n     */\r\n    var tdTemplateWithError = '<td>{{formName}}</td><td>{{lastUpdated}}</td>' +\r\n        '<td> <button type=\"button\" class=\"btn btn-primary error-close\"  aria-hidden=\"true\"   data-toggle=\"popover\" data-placement=\"bottom\" data-html=\"true\" ' +\r\n        '\t\t\tdata-content=\"{{error_message}}\"><span  class=\"pull-left status-descr\" >{{status}}</span></button></td>' +\r\n        '<td> <button type=\"button\" class=\"close\" aria-hidden=\"true\"   data-toggle=\"popover\" data-placement=\"left\" data-html=\"true\" ' +\r\n        '\t\t\tdata-content=\"' + deletePopoverTemplateWithGUID + '\"><i class=\"fa\"></i></button></td>';\r\n   \r\n    /**\r\n     * Table Row template for workitems listing .\r\n     */\r\n    var wiListRowTemplate = '<tr class=\"{{styleClass}}\" ><td>{{workItemId}}</td> <td> {{lobTitle}}</td><td>  {{url}} </td></tr>';\r\n    \r\n    \r\n    /**\r\n     * Table Row template for workitems listing .\r\n     */\r\n    var wiListRowTemplateError = '<tr class=\"{{styleClass}}\" ><td>{{workItemId}}</td> <td> {{lobTitle}}</td><td><button type=\"button\" class=\"btn btn-primary pull-right\" aria-hidden=\"true\" data-toggle=\"popover\" data-placement=\"bottom\" data-html=\"true\" ' +\r\n    \t\t\t'data-content=\"{{error}}\"><span  class=\"pull-left status-descr\">' + ap.core_prompts[\"action.Error\"] + '</span></button></td></tr>';\r\n\r\n    /**\r\n     * Header section for Forms Processed.\r\n     */\r\n    var formsHeading = '<div class=\"list-group-item\"><h4 class=\"list-group-item-heading\">' + ap.core_prompts[\"header.Title.FormsProcesses\"] + '</h4></div>';\r\n\r\n    /**\r\n     * Header section for Forms Not Processed.\r\n     */\r\n    var formsNotProcessedHeading =\t'<div class=\"list-group-item\">'\r\n    \t\t\t\t\t\t\t+\t'<h4 class=\"list-group-item-heading toggler forms-not-processed\">'\r\n    \t\t\t\t\t\t\t+\t'<a data-toggle=\"collapse\" data-target=\".unprocessed-forms\" href=\"#unprocessed-forms\" class=\"collapsed\">'\r\n    \t\t\t\t\t\t\t+\t'<i class=\"fa\"></i> <span>' + ap.core_prompts[\"header.Title.FormsNotProcessed\"] + ': ' + '{{noforms}}' +'</span></a>'\r\n    \t\t\t\t\t\t\t+\t'</h4>'\r\n    \t\t\t\t\t\t\t+\t'<div id=\"unprocessed-forms\" class=\"{{dropDefault}} unprocessed-forms\">{{formsList}}</div>'\r\n    \t\t\t\t\t\t\t+\t'</div>';\r\n    \r\n    /**\r\n     * Header section for Forms Not Processed.\r\n     */\r\n    var formsNotRecognizedHeading =\t'<div class=\"list-group-item\">'\r\n    \t\t\t\t\t\t\t+\t'<h4 class=\"list-group-item-heading toggler forms-not-processed\">'\r\n    \t\t\t\t\t\t\t+\t'<a data-toggle=\"collapse\" data-target=\".unprocessed-pages\" href=\"#unprocessed-pages\" class=\"collapsed\">'\r\n    \t\t\t\t\t\t\t+\t'<i class=\"fa\"></i><span>' + ap.core_prompts[\"header.Title.PagesNotRecognized\"] + ': ' + '{{noforms}}' + '</span></a>'\r\n    \t\t\t\t\t\t\t+\t'</h4>'\r\n    \t\t\t\t\t\t\t+\t'<div id=\"unprocessed-pages\" class=\"{{dropDefault}} unprocessed-pages\">{{formsList}}</div>'\r\n    \t\t\t\t\t\t\t+\t'</div>';\r\n    \r\n    /**\r\n     * repeating template for the list of forms\r\n     */\r\n    var formsTemplate = '<div class=\"list-group-item\">{{formId}}</div>';\r\n\r\n    /**\r\n     * File List Row template.. the table row that displays the file name, size and delete action.\r\n     */\r\n\tvar fileListRowTemplate = '<tr {{class}} ><td class=\"file-name\">{{fileName}}</td><td class=\"file-size\">{{fileSize}}</td><td class=\"file-action\">{{action}}</td></tr>';\r\n\t\r\n\t/**\r\n\t * Alert template for file validation\r\n\t */\r\n\tvar fileUploaderAlertdivTemplate = '<div id=\"file-uploader-validation-message\" class=\"alert alert-danger\">{{message}}</div>';\r\n\t\r\n\t/**\r\n\t * Alert template for status view\r\n\t */\r\n\tvar showStatusAlertdivTemplate = '<div id=\"show-status-validation-message\" class=\"alert alert-danger\">{{message}}</div>';\r\n\t\r\n\tvar accountMessageTemplate = '<span>' + \"{{message}}\" + ' <b>{{accountName}}</b>.</span>'; \r\n\t\r\n\tvar spinnerSpan = $('<span class=\"pull-right spinner-container\"></span>') ;\r\n\t\r\n\t\r\n\t/**\r\n\t * Currently selected account ID , set from call back of search results.\r\n\t */\r\n\tthis.currentAccountId = null ;\r\n\t\r\n\t/**\r\n\t * Progress Spinnner widget options.\r\n\t */\r\n\tvar spinnerOpts = {\r\n\t\t\t  lines: 8, // The number of lines to draw\r\n\t\t\t  length: 3, // The length of each line\r\n\t\t\t  width: 4, // The line thickness\r\n\t\t\t  radius: 2, // The radius of the inner circle\r\n\t\t\t  corners: 1, // Corner roundness (0..1)\r\n\t\t\t  rotate: 0, // The rotation offset\r\n\t\t\t  direction: 1, // 1: clockwise, -1: counterclockwise\r\n\t\t\t  color: '#fff', // #rgb or #rrggbb or array of colors\r\n\t\t\t  speed: 1, // Rounds per second\r\n\t\t\t  trail: 20, // Afterglow percentage\r\n\t\t\t  shadow: false, // Whether to render a shadow\r\n\t\t\t  hwaccel: false, // Whether to use hardware acceleration\r\n\t\t\t  className: 'spinner', // The CSS class to assign to the spinner\r\n\t\t\t  zIndex: 2e9, // The z-index (defaults to 2000000000)\r\n\t\t\t  top: '50%', // Top position relative to parent\r\n\t\t\t  left: '90%' // Left position relative to parent\r\n\t\t\t};\r\n\t\r\n\t/**\r\n\t* File upload Data - blueimp object that holds on to the files that are selected\r\n\t* for uploading.\r\n\t* <code>files</code> holds the files list after a process is applied.\r\n\t*/\r\n\tthis.fileUploadData = null;\r\n\t\r\n\tthis.widgetOpen = false;\r\n\t/**\r\n\t * Launch the Turnstile upload widget - Launch point is generally global.\r\n\t * @param accountId  - optional parameter. if present, this has to be a valid account number. \r\n\t * \tuploaded workitems will be associated with the selected account, identified by the accountID.\r\n\t */\r\n\tthis.launchUploadWidget = function ( accountId ) {\r\n\t\tthis.resetFileuploadSection();\r\n\t\t$(\"#turnstile-upload-widget\").modal('show');\r\n\t\t\r\n\t\tthis.currentAccountId = accountId ? accountId : null ; // Note that accountId can be undefined, this condition is utilized when account association decision is made.\r\n\t};\r\n\t\r\n\t\r\n\t/**\r\n\t * File upload section reset. \r\n\t */\r\n\tthis.resetFileuploadSection = function (){\r\n\t\t\r\n\t\t$(\"#file-uploader-widget button\").attr(\"disabled\", false);\r\n\t\t$(\"#file-uploader-validation-message\").remove();\r\n\t\t$('a[href=\"#turnstile-files-selector\"]').tab('show');\r\n\t\t\r\n\t\t$(\"#fileupload-file-listing\").html('');\r\n\t\t\r\n\t\tthis.fileUploadData = null;\r\n\t};\r\n\r\n \r\n\t\r\n    /**\r\n     * Process the Staged Upload item, Default implementation opens the LOB Transaction list.\r\n     * should a different workflow is desired, override this function and apply your processing logic.  \r\n     * @param guid - the guid associated with the staged item.\r\n     */\r\n    this.processStagedUpload = function(guid){\r\n    \t$('#turnstile-file-upload-status').scrollTop(0);\r\n    \tthis.showLobSelector(guid); \r\n    };\r\n    \r\n \r\n    /**\r\n     * Delete a staged item.\r\n     */\r\n    this.deleteStagedItem = function (guid) {\r\n\r\n        $.ajax({\r\n            type: \"POST\",\r\n            url: turnstileServiceURL,\r\n            dataType: \"JSON\",\r\n            data: {\r\n                'requestType': \"delete\",\r\n                'guid': guid\r\n            }\r\n        }).always(function () {\r\n                ap.turnstileWidget.showUploadStatus();\r\n           });\r\n    };\r\n\r\n\t\r\n    \r\n    this.renderUploadStatusTableContent = function ( msg ){\r\n\r\n        var innerHTML = '';\r\n        \r\n        msg.list.forEach( function (val, index ) {\r\n    \r\n            if(val.status != 4 ){\r\n            \tvar tmp = rowTemplate;\r\n            \tinnerHTML += tmp.split(\"{{formName}}\").join(val.fileName).split(\"{{lastUpdated}}\").join(val.lastUpdateTime)\r\n            \t.split(\"{{disabled}}\").join(val.status == 3 ? 'onclick=\"ap.turnstileWidget.processStagedUpload(\\'{{GUID}}\\')\"' : 'disabled')\r\n            \t.split(\"{{spinner-container}}\").join( (val.status == 1 || val.status == 2) ? '<span class=\"pull-right spinner-container\"></span> ' : '')\r\n            \t.split(\"{{status}}\").join(val.statusDesc)\r\n            \t.split(\"{{GUID}}\").join(val.guid)\r\n            \t.split(\"{{BGUID}}\").join(val.guid);\r\n            }else{\r\n            \tvar tmp = rowTemplateWithError;\r\n            \tif (index === msg.list.length - 1) {\r\n            \t\ttmp = tmp.replace(\"{{popovertype}}\",\"top\");\r\n                \t\r\n            \t} else {\r\n            \t\ttmp = tmp.replace(\"{{popovertype}}\", \"bottom\")\r\n            \t}  \r\n            \tinnerHTML += tmp.split(\"{{formName}}\").join(val.fileName).split(\"{{lastUpdated}}\").join(val.lastUpdateTime)\r\n            \t.split(\"{{error_message}}\").join(val.message)\r\n            \t.split(\"{{GUID}}\").join(val.guid)\r\n            \t.split(\"{{BGUID}}\").join(val.guid)\r\n            \t.split(\"{{status}}\").join(val.statusDesc);\r\n            }\r\n        });\r\n        \r\n       \r\n        $('#turnstile-report-table').html(innerHTML);\r\n        \r\n        \r\n        // Set up the pop over on the close button.\r\n        $('#turnstile-report-table .close').popover()\r\n            .on('shown.bs.popover', function () {\r\n                var $popup = $(this);\r\n                $(this).next('.popover').find('button.cancel').click(function (e) {\r\n                    $popup.popover('hide');\r\n                });\r\n                $(this).next('.popover').find('button.ok').click(function (e) {\r\n                    $popup.popover('hide');\r\n                    ap.turnstileWidget.deleteStagedItem($(this).attr(\"id\"));\r\n                });\r\n\t\t\t});\r\n        \r\n        var spinner = new Spinner(spinnerOpts).spin();\r\n        $('#turnstile-report-table button .spinner-container').append(spinner.el);\r\n        \r\n        $(\"#turnstile-report-table\").find('[data-toggle=\"popover\"]').each(function () {\r\n            $(this).popover('show');\r\n            $(this).popover('hide');\r\n        });\r\n        \r\n        //close popover while clicking outside\r\n        $('body').on('click', function (e) {\r\n            $('[data-toggle=\"popover\"]').each(function () {\r\n                if (!$(this).is(e.target) && $(this).has(e.target).length === 0 && $('.popover').has(e.target).length === 0) {\r\n                    $(this).popover('hide');\r\n                }\r\n            });\r\n        });\r\n   \r\n    };\r\n    \r\n    \r\n    this.updateUploadStatusTableContent = function (msg, previousMessage) {\r\n    \t\r\n    \t//check the existing items\r\n    \tvar $self = this;\r\n    \tvar dataGuids = $('#turnstile-report-table').find('tr[data-guid]');\r\n    \tif(dataGuids.length != msg.list.length){\r\n    \t\t$self.renderUploadStatusTableContent(msg);\r\n    \t\treturn;   \r\n    \t}\r\n    \t\r\n        msg.list.forEach( function (val, index ) {\r\n        \t// Previous and current GUID matches - indicating that the indexed element on the list has not changed\r\n        \t// this would mean - we can check the status and call for update if needed. \r\n        \ttry{\r\n        \t\tif( val.guid === previousMessage.list[index].guid ){\r\n        \t\t\tif( val.status != previousMessage.list[index].status ){\r\n\r\n        \t\t\t\tvar button = $('#turnstile-report-table tr:eq('+ index +') .btn-primary');\r\n        \t\t\t\tbutton.find('.status-descr').html(val.statusDesc); \r\n\r\n        \t\t\t\tif(val.status == 3){\r\n        \t\t\t\t\tbutton.find('.spinner-container').remove();\r\n        \t\t\t\t\tbutton.off('click');\r\n        \t\t\t\t\tbutton.on('click', function ( ){ ap.turnstileWidget.processStagedUpload( val.guid );});\r\n        \t\t\t\t\tbutton.removeAttr('disabled');\r\n        \t\t\t\t}else{        \t\t\t\t\r\n        \t\t\t\t\tvar tr = $('#turnstile-report-table tr:eq('+ index +')');\r\n        \t\t\t\t\tvar tmp = tdTemplateWithError;\r\n        \t\t\t\t\tvar innerHTML =  tmp.split(\"{{formName}}\").join(val.fileName).split(\"{{lastUpdated}}\").join(val.lastUpdateTime)\r\n        \t\t\t\t\t.split(\"{{error_message}}\").join(val.message)\r\n        \t\t\t\t\t.split(\"{{GUID}}\").join(val.guid)\r\n        \t\t\t\t\t.split(\"{{BGUID}}\").join(val.guid)\r\n        \t\t\t\t\t.split(\"{{status}}\").join(val.statusDesc);\r\n\r\n        \t\t\t\t\ttr.html(innerHTML);\r\n        \t\t\t\t\t$(\"#turnstile-report-table\").find('[data-toggle=\"popover\"]').each(function () {\r\n        \t\t\t\t\t\t$(this).popover('show');\r\n        \t\t\t\t\t\t$(this).popover('hide');\r\n        \t\t\t\t\t});\r\n\r\n        \t\t\t\t\t// Set up the pop over on the close button.\r\n        \t\t\t\t\t$('#turnstile-report-table .close').popover()\r\n        \t\t\t\t\t.on('shown.bs.popover', function () {\r\n        \t\t\t\t\t\tvar $popup = $(this);\r\n        \t\t\t\t\t\t$(this).next('.popover').find('button.cancel').click(function (e) {\r\n        \t\t\t\t\t\t\t$popup.popover('hide');\r\n        \t\t\t\t\t\t});\r\n        \t\t\t\t\t\t$(this).next('.popover').find('button.ok').click(function (e) {\r\n        \t\t\t\t\t\t\t$popup.popover('hide');\r\n        \t\t\t\t\t\t\tap.turnstileWidget.deleteStagedItem($(this).attr(\"id\"));\r\n        \t\t\t\t\t\t});\r\n        \t\t\t\t\t});\r\n        \t\t\t\t}\r\n        \t\t\t}\r\n        \t\t}else{\r\n        \t\t\t// GUID does not match - abort update operation - call for full re-render.\r\n        \t\t\t// Not attempting to salvage the table etc as it could be more expensive operation to perform.\r\n        \t\t\t$self.renderUploadStatusTableContent(msg);\r\n        \t\t\treturn;  // no point in continuing with loop execution. \r\n        \t\t}\r\n        \t}catch(err){\r\n        \t\t$self.renderUploadStatusTableContent(msg);\r\n        \t\treturn;   \r\n        \t}\r\n        });\r\n        \r\n    };\r\n   \r\n    \r\n    /**\r\n     * Show upload status -  displays the modal dialog with the latest TS processing progress information,\r\n     * \r\n     */\r\n    this.showUploadStatus = function ( previousMessage) {\r\n    \t\r\n    \tif(ap.environment.isTurnstileEnabled){\r\n    \t\tvar $self = this; \r\n\r\n    \t\t$(\"#show-status-validation-message\").remove();\r\n\r\n    \t\t$.ajax({\r\n    \t\t\ttype: \"POST\",\r\n    \t\t\turl: turnstileServiceURL,\r\n    \t\t\tdataType: \"JSON\",\r\n    \t\t\tdata: {\r\n    \t\t\t\t'requestType': \"list\"\r\n    \t\t\t}\r\n    \t\t}).done(function (msg) {\r\n    \t\t\tap.consoleInfo(\"Turnstile Status Message status \" + msg.status);\r\n    \t\t\tif (msg.status === 'success') {\r\n\r\n    \t\t\t\tif(previousMessage){\r\n\r\n    \t\t\t\t\t$self.updateUploadStatusTableContent(msg, previousMessage);\r\n\r\n    \t\t\t\t}else{\r\n    \t\t\t\t\t// Render the list\r\n    \t\t\t\t\t$self.renderUploadStatusTableContent(msg);\r\n\r\n    \t\t\t\t}\r\n    \t\t\t\tvar txt = $('a[href=\"#turnstile-file-upload-status\"]').html();\r\n    \t\t\t\tif(msg.list.length){\r\n\r\n\r\n    \t\t\t\t\t$('a[href=\"#turnstile-file-upload-status\"]').html( txt.replace( /\\s\\((\\d+)\\)/, \"\") + \" (\" + msg.list.length +\")\" ); \r\n    \t\t\t\t\t$('#upload-status-count').html(msg.list.length);\r\n    \t\t\t\t}else{\r\n\r\n    \t\t\t\t\t$('a[href=\"#turnstile-file-upload-status\"]').html( txt.replace( /\\s\\((\\d+)\\)/, \"\") ); \r\n    \t\t\t\t\t$('#upload-status-count').html(\"\");\r\n    \t\t\t\t\t$('#turnstile-report-table').html(\"<tr><td>\" + ap.core_prompts[\"label.Template.NoUploadForms\"] + \"</td></tr>\");\r\n    \t\t\t\t}\r\n\r\n    \t\t\t\tif($self.widgetOpen){                \r\n    \t\t\t\t\tsetTimeout( function(){ $self.showUploadStatus( msg );}, $self.refreshTimeout);                     \r\n    \t\t\t\t}else{\r\n    \t\t\t\t\tap.consoleInfo('Turnstile widget is closed. Stop updating Turnstile upload status.');\r\n    \t\t\t\t}\r\n\r\n    \t\t\t}\r\n    \t\t\tif(msg.status === 'error'){\r\n    \t\t\t\t$('#turnstile-report-table').closest('table').prepend(\r\n    \t\t\t\t\t\tshowStatusAlertdivTemplate.split('{{message}}').join(msg.message) \r\n    \t\t\t\t);\r\n    \t\t\t}\r\n\r\n    \t\t});\r\n    \t}\r\n    };\r\n\r\n    /**\r\n     * Display the LOB selector modal.\r\n     */\r\n    this.showLobSelector = function (guid) {\r\n\r\n    \t$('#turnstile-stage-guid').val(\"\");\r\n\r\n        $.ajax({\r\n            type: \"POST\",\r\n            url: turnstileServiceURL,\r\n            dataType: \"JSON\",\r\n            data: {\r\n                'requestType': \"forms\",\r\n                'guid': guid\r\n            }\r\n        })\r\n        .done(function (data) {\r\n        \tap.consoleInfo(data);\r\n            var tmpHtml = formsHeading;\r\n            var formsList = data.forms.split(\",\");\r\n\r\n            $.each(formsList, function (key, value) {\r\n                tmpHtml += formsTemplate.split(\"{{formId}}\").join(value);\r\n            });\r\n\r\n            $('#forms-list').html(tmpHtml);\r\n\r\n            $('#turnstile-transaction-list input[type=\"checkbox\"]').attr('checked', false);\r\n            $('#turnstile-lob-selector').modal();\r\n            $('#turnstile-stage-guid').val(guid);\r\n            \r\n            //form not processed           \r\n            tmpHtml = formsNotProcessedHeading;\r\n            var errorformsList = data.notSupportedForms.split(\",\");\r\n            var errorFormsHtml = \"\";\r\n            var numErrors = 0;\r\n            if(errorformsList[0].length == 0){\r\n            \terrorFormsHtml += formsTemplate.split(\"{{formId}}\").join(\"None\"); \r\n            \ttmpHtml = tmpHtml.replace(\"{{dropDefault}}\",\"collapse in\");\r\n            \ttmpHtml = tmpHtml.replace(\"{{noforms}}\", numErrors);\r\n            }else{\r\n                $.each(errorformsList, function (key, value) {\r\n                \terrorFormsHtml += formsTemplate.split(\"{{formId}}\").join(value);\r\n                });  \r\n                numErrors = errorformsList.length;\r\n            \ttmpHtml = tmpHtml.replace(\"{{noforms}}\", numErrors);\r\n            \ttmpHtml = tmpHtml.replace(\"{{dropDefault}}\",\"collapse\");\r\n            }\r\n           \r\n            tmpHtml = tmpHtml.replace(\"{{formsList}}\", errorFormsHtml);\r\n            $('#error-forms-list').html(tmpHtml);\r\n            \r\n            tmpHtml = formsNotRecognizedHeading;\r\n            \r\n            errorformsList = [];\r\n            var pageCount = 0;\r\n            for(var file in data.notRecognizedForms) {\r\n            \tif(!data.notRecognizedForms.hasOwnProperty(file)){\r\n            \t\tcontinue;\r\n            \t}\r\n            \tvar pages = data.notRecognizedForms[file];\r\n            \tpageCount+= pages.length;\r\n            \terrorformsList.push(file + ' [' + pages + ']');\r\n            }\r\n            \r\n            errorFormsHtml = \"\";\r\n            if(errorformsList.length == 0){\r\n            \terrorFormsHtml += formsTemplate.split(\"{{formId}}\").join(\"None\"); \r\n            \ttmpHtml = tmpHtml.replace(\"{{dropDefault}}\",\"collapse in\");\r\n            \ttmpHtml = tmpHtml.replace(\"{{noforms}}\", pageCount);\r\n            \t\r\n            }else{\r\n                $.each(errorformsList, function (key, value) {\r\n                \terrorFormsHtml += formsTemplate.split(\"{{formId}}\").join(value);\r\n                }); \r\n            \ttmpHtml = tmpHtml.replace(\"{{noforms}}\", pageCount);\r\n            \ttmpHtml = tmpHtml.replace(\"{{dropDefault}}\",\"collapse\");\r\n            }\r\n            tmpHtml = tmpHtml.replace(\"{{formsList}}\", errorFormsHtml)\r\n            $('#unknown-forms-list').html(tmpHtml);\r\n            \r\n        });\r\n\r\n    };\r\n    \r\n    \r\n    /**\r\n     * Resets the lightbox, Removes any validation messages and returns scrollbars to top position.\r\n     */\r\n\tthis.resetLightboxState = function() {\r\n\t\t$('#lob-validation-message').html('');\r\n\t\t$('#lob-validation-message').hide();\r\n\t\t$('#forms-list').scrollTop(0);\r\n\t}; \r\n\t\r\n\t\r\n    /**\r\n     * Process the Continue of LOB Selection  \r\n     * Override if the workflow needs to be altered. \r\n     */\r\n    this.processLobSelection = function (){\r\n    \t\r\n    \t \r\n    \tvar $self = this;\r\n    \t// Validate that at least one transaction is selected. \r\n    \tif(!$('input[name=\"transactions\"]:checked').length){\r\n    \t\t$('#lob-validation-message').html(ap.core_prompts[\"prompt.Template.SelectLOB\"]);\r\n    \t\t$('#lob-validation-message').show();\r\n    \t\treturn false;\r\n    \t}\r\n    \t\r\n    \tthis.resetLightboxState();\r\n    \t\r\n    \tif(ap.environment.isAccountManagementFeatureOn){\r\n    \t\r\n    \t\t// Move on to the Account Modals. \r\n    \t\t$('#turnstile-lob-selector').modal('hide');\r\n        \t\r\n    \t\t// if self has an account number, then skip the account number selection. create workitems and \r\n    \t\t// associate with account at hand. \r\n    \t\tif( $self.currentAccountId != null ){\r\n    \t\t\t\r\n    \t\t\t$self.addProgressIndicatorSpinner($('#turnstile-lob-selector button.continue'));\r\n    \t    \t$('#turnstile-account-selector button').attr(\"disabled\", \"disabled\");\r\n    \t    \t\r\n    \t\t\t// provide call back to hide the modal\r\n    \t\t\tthis.createWorkItems(function(){ \r\n    \t\t\t\t\t$self.removeSpinnerControl($('#turnstile-lob-selector button.continue'));\r\n    \t\t\t\t\t$('#turnstile-lob-selector').modal('hide');\r\n    \t\t\t\t\t$self.currentAccountId = null ; // setting back to null.\r\n    \t\t\t\t}, $self.currentAccountId );\r\n    \t\t}else{\r\n        \t\t// Move on to the Account Modals. \r\n        \t\t$('#turnstile-lob-selector').modal('hide');\r\n            \t$('#turnstile-account-selector').modal('show');\r\n    \t\t}\r\n        \t\r\n    \t}else{ \r\n    \t\t\r\n    \t\t// Set up the spinner and wait for the processing to finish up.\r\n    \t\t$self.addProgressIndicatorSpinner($('#turnstile-lob-selector button.continue'));\r\n        \t\r\n        \t$('#turnstile-lob-selector button').attr(\"disabled\", \"disabled\");\r\n        \t\r\n        \tthis.createWorkItems( function() {\r\n        \t\t\t\t$('#turnstile-lob-selector').modal('hide');\r\n        \t\t\t\t$('#turnstile-lob-selector button').removeAttr(\"disabled\");\r\n        \t\t\t\t\r\n        \t\t\t\t$self.removeSpinnerControl($('#turnstile-lob-selector button.continue'));\r\n        \t\t\t});\r\n    \t}\r\n    \t\r\n    \t\r\n    };\r\n    \r\n    /**\r\n     * appends a progress indicator spinner control to the jQuery element object passed in.\r\n     * @param element - jQuery Element on which the spinner is to be attached.\r\n     */\r\n    this.addProgressIndicatorSpinner = function(element){\r\n       \tvar spinner = new Spinner(spinnerOpts).spin();\r\n    \tspinnerSpan.append(spinner.el);\r\n    \telement.append(spinnerSpan);\r\n    };\r\n    \r\n    /**\r\n     * Removes a spiner from an element. \r\n     * @param element - object on which the spinner is attached.\r\n     */\r\n    this.removeSpinnerControl = function(element){\r\n    \telement.find('.spinner-container').remove();\r\n    }; \r\n    \r\n    /**\r\n     * Process cancel action. brings the user back to the status page.\r\n     */\r\n    this.cancelLobSelection = function() {\r\n    \tthis.resetLightboxState();\r\n    \tthis.launchUploadWidget( this.currentAccountId);\r\n    };\r\n    \r\n    \r\n    \r\n    /**\r\n     * Indicates if the file upload control has been initialized for the page or not, will be set to true on first access.\r\n     */\r\n    this.fileuploadControlInitialized = false ;\r\n    \r\n    /**\r\n     * The file uploader ( blue imp ) library setup \r\n     * The file uploader control initialization is done only on modal dialog access. \r\n     */\r\n    this.setupFileuploaderControls = function ( fileControl, fileDropZone) {\r\n    \tif( !this.fileuploadControlInitialized ) {\r\n    \t\tthis.fileuploadControlInitialized = true;\r\n\r\n    \t\tvar $self = this ;\r\n    \t\t/*\r\n    \t\t * setup blue-imp library\r\n    \t\t */\t\t\r\n    \t\t$('#'+fileControl).fileupload({\r\n    \t\t\turl: turnstileServiceURL,\r\n    \t\t\tdataType: 'json',\r\n    \t\t\tautoUpload: false,\r\n    \t\t\tsingleFileUploads: false,\r\n    \t\t\tacceptFileTypes: /(\\.|\\/)(tiff|pdf|zip)$/i,\r\n    \t\t\tdropZone : $('#' + fileDropZone),\r\n    \t\t\tmaxFileSize: 15000000} //15 MB\r\n    \t\t).on('fileuploadadd', function (e, data) {\r\n    \t\t\t\r\n    \t\t\t$('#file-uploader-validation-message').remove();\r\n    \t\t\t\r\n    \t\t\tif(null === $self.fileUploadData ){\r\n    \t\t\t\t\r\n    \t\t\t\t$self.fileUploadData = $.extend({},data);\r\n    \t\t\t\t$self.fileUploadData.files = [];\r\n    \t\t\t}\r\n    \t\t\t  \r\n    \t\t}).on('fileuploadprocessalways', function (e, data) {\r\n    \t\t\t\r\n    \t\t\tvar file = data.files[data.index];\r\n    \t\t\tvar tmpRow, tmpClass, fileName = '';\r\n    \t\t\t\r\n    \t\t\tif(file.error){\r\n    \t\t\t\tfileName = '<i class=\"fa fa-exclamation-triangle\"  data-toggle=\"tooltip\" data-placement=\"top\" title=\"'+file.error+'\" ></i> '+file.name;\r\n    \t\t\t\ttmpClass = 'class=\"danger\"';\r\n    \t\t\t}else{\r\n    \t\t\t\tfileName = file.name;\r\n    \t\t\t}\r\n    \t\t\t\r\n    \t\t\t$self.fileUploadData.files.push(file);\r\n    \t\t\t\r\n    \t\t\tvar  fileSize = \"\";\r\n    \t\t\tif(file && file.size < 1048576 ){\r\n    \t\t\t\tfileSize = Math.round(file.size / 1024) + ' KB';\r\n    \t\t\t}\r\n    \t\t\telse if(file && file.size >= 1048576) {\r\n    \t\t\t\tfileSize = (file.size / 1048576).toFixed(2) + ' MB';\r\n    \t\t\t}\r\n    \t\t\ttmpRow = fileListRowTemplate.split(\"{{fileName}}\").join(fileName)\r\n    \t\t\t\t\t\t\t\t\t\t.split(\"{{fileSize}}\").join(fileSize)\r\n    \t\t\t\t\t\t\t\t\t\t.split(\"{{class}}\").join(tmpClass)\r\n    \t\t\t\t\t\t\t\t\t\t.split(\"{{action}}\").join(fileDeleteAction);\r\n    \t\t\t\r\n    \t\t\t\r\n    \t\t\tvar fileRow = $(tmpRow);\r\n    \t\t\t\r\n    \t\t\t\r\n    \t\t\t// Initialize the delete pop over and tool tip\r\n    \t\t\tfileRow.find('button').popover()\r\n    \t\t\t\t.on('shown.bs.popover', function () {\r\n    \t\t\t\t\tvar $popup = $(this);\r\n    \t\t\t\t\t$(this).next('.popover').find('button.cancel').click(function (e) {\r\n                        $popup.popover('hide');\r\n    \t\t\t\t});\r\n                    $(this).next('.popover').find('button.ok').click(function (e) {\r\n                        $popup.popover('hide');\r\n                        ap.turnstileWidget.deleteRow(fileRow);\r\n                    });\r\n    \t\t\t});\r\n    \t\t\t\r\n    \t\t\tfileRow.find('.fa-exclamation-triangle').tooltip();\t\t\r\n    \t\t\t\r\n    \t\t\t$(\"#fileupload-file-listing\").append(fileRow);\r\n    \t\r\n    \t\t\t\r\n    \t\t}).on('fileuploadprogressall',function (e, data) {\r\n    \t\t\t\r\n    \t\t\t var progress = parseInt(data.loaded / data.total * 100, 10);\r\n    \t\t\t if( !$('#file-uploader-widget div.progress-bar-danger').length){ \r\n    \t\t        $('#file-uploader-widget .progress-bar').css('width', progress + '%');\r\n    \t\t\t }\r\n    \t\t        \r\n    \t\t}).on('fileuploadfail',function (e, data) {\r\n    \t\t\t \r\n    \t\t\t$self.prependAertMessage(data.response().jqXHR.responseJSON.message);\r\n    \t\t\t$(\"#file-uploader-widget \").prepend(message);\r\n  \r\n    \t\t}).on('fileuploaddone',function (e, data) {\r\n    \t\t\t\r\n    \t\t\t$self.resetFileuploadSection();\r\n    \t\t\t$('a[href=\"#turnstile-file-upload-status\"]').tab('show');\r\n    \t\t\t\r\n    \t\t}).on('fileuploaddragover',function (e, data){\r\n    \t\t\t// Tab is set to lit up to background color \r\n    \t\t\t$('#turnstile-files-selector').find(\".file-drop-zone\").addClass('dropping-in');\r\n    \t\t\t\r\n    \t\t});\r\n    \t\t\r\n    \t\t// Prevent drag & drop over document \r\n    \t\t$(document).bind('drop dragover', function (e) {\r\n    \t\t    e.preventDefault();\r\n    \t\t});\r\n    \t\t\r\n    \t\t// lit up drop zone.\r\n    \t\t\r\n    \t\t// turn off the lights when the user leaves the drop zone.\r\n    \t\t\r\n    \t\t$('#turnstile-files-selector').parent().on('dragleave drop', function (e) {\r\n    \t\t\t$('#turnstile-files-selector').find(\".file-drop-zone\").removeClass('dropping-in');\r\n    \t\t});\r\n    \t}\r\n    };\r\n\r\n    var resetAccountSearchModal = function ( accountSearchmanager ){\r\n    \t\r\n    \t$('#turnstile-account-selector button').removeAttr('disabled');\r\n\t\t$('#turnstile-account-search').addClass('hidden');\r\n\t\taccountSearchmanager.reset();\r\n    };\r\n    \r\n\t/**\r\n\t* Setup the file upload widget. Initialize the blueimp uploader.\r\n\t*/\r\n    this.setup = function (args) {\r\n\r\n        if (!args.length) {\r\n            ap.consoleError(ap.core_prompts[\"message.Template.UploadHandlerElementNotFound\"]);\r\n            return;\r\n        }\r\n        \r\n        if(!ap.environment.isTurnstileEnabled){\r\n        \treturn;\r\n        }\r\n        \r\n        this.showUploadStatus();\r\n        \r\n    \tvar $self = this;\r\n\r\n    \t/*\r\n    \t * Event registry  \r\n    \t */ \r\n    \t$('#file-uploader-widget button[type=\"submit\"]').on('click', function(e){ $self.startUpload();}) ;\r\n    \t/*\r\n    \t * On Tab show, refresh the list of items.\r\n    \t */\r\n    \t$('a[href=\"#turnstile-file-upload-status\"]').on('show.bs.tab', function (e) { $self.showUploadStatus(); });\r\n\r\n    \t$('#turnstile-lob-selector button.continue').on('click', function(e){ $self.processLobSelection(); });\r\n    \t$('#turnstile-lob-selector button.cancel').on('click', function(e){ $self.cancelLobSelection(); });\r\n    \t$('#turnstile-lob-selector button.close').on('click', function(e){ $self.resetLightboxState(); });\r\n    \t$('#turnstile-upload-widget button.close').on('click', function(e){ $self.resetLightboxState(); });\r\n     \r\n    \tvar tsSelectAccount =   function ( element, event  ) {\r\n\r\n\t\t\tvar accountId = element.closest('tr').attr('id').split('_')[1]; \r\n\t\t\t\r\n\t\t\tap.consoleInfo(\"Selected \"+accountId+\" account for turnstile attach\");\r\n\t\t\t\r\n\t\t\t$self.currentAccountId = accountId ; // Set up the current account selection. \r\n\t\t\t$self.createWorkItemsWithAccount($self.currentAccountId); \r\n\t\t\t$self.currentAccountId = null;\r\n    \t\r\n    \t };\r\n    \t\t \r\n    \t\r\n    \tvar accountSearchmanager = new ap.ModalAccountSearchManager('turnstile-account-search-input', 'turnstile-account-search-button', 'turnstile-account-search-results-listing',  tsSelectAccount, false );\r\n    \t\r\n    \t\r\n    \tthis.setupFileuploaderControls(args[0],args[1]);\r\n\t\r\n\t\t\r\n\t\t// Prevent drag & drop over document \r\n\t\t$(document).bind('drop dragover', function (e) {\r\n\t\t    e.preventDefault();\r\n\t\t});\r\n\t\t\r\n\t\t$('#turnstile-files-selector').parent().on('dragleave drop', function (e) {\r\n\t\t\t$('#turnstile-files-selector').parent().removeClass('drop-in'); \r\n\t\t});\r\n\t\t\t\r\n\t\t/*\r\n\t\t * Account Search toggle click - active and inactive state handling.\r\n\t\t */\r\n\t\t$('#turnstile-account-selector .account-search-button').on('click', function(e){\r\n\t\t\t\r\n\t\t\tif($(this).hasClass('active')){\r\n\t\t\t\tresetAccountSearchModal(accountSearchmanager);\r\n\t\t\t}else{\r\n\t\t\t\t$('#turnstile-account-search').removeClass('hidden'); \r\n\t\t\t\t$('#turnstile-account-selector button:not(.account-search-button,.close, #turnstile-account-search-button,.no-account,.new-account)').attr('disabled','disabled');\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$('#turnstile-account-selector').on('show.bs.modal', function (e) {\r\n\t\t\t$('#turnstile-account-selector .account-search-button').removeClass('active');\r\n\t\t\tresetAccountSearchModal(accountSearchmanager);\r\n\t\t});\r\n\t\t\r\n\t\tif($('ul.get-started').length > 0){\t\t\t\r\n\t\t\t\r\n\t\t\t$('ul.get-started').on('shown.bs.dropdown', function (e) { \r\n\t\t\t\t$self.widgetOpen = true;\r\n\t\t\t\t$self.showUploadStatus(); \r\n\t\t\t\tap.consoleInfo('Get-Started:  Start Turnstile upload status update.');\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t$('ul.get-started').on('hidden.bs.dropdown', function (e) { \t\t\t\t\r\n\t\t\t\tap.consoleInfo('Get-Started: Stop Turnstile upload status update.');\r\n\t\t\t\t$self.widgetOpen = false;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t$('#turnstile-upload-widget').on('show.bs.modal', function (e) {\r\n\t\t\t$self.widgetOpen = true;\r\n\t\t\t$self.showUploadStatus(); \r\n\t\t\tap.consoleInfo('Turnstile Widget is open. updating Turnstile upload status.');\r\n\t\t});\r\n\r\n\t\t$('#turnstile-upload-widget').on('hidden.bs.modal', function (e) {\r\n\t\t\t$self.widgetOpen = false;\r\n\t\t});\r\n\t};\r\n\t\r\n\r\n\tthis.deleteRow = function (element) {\r\n\t\tvar ix = $(element).index();\r\n\t\tthis.fileUploadData.files.splice(ix,1);\r\n\t\t$(element).remove();\r\n\t\t$(\"#file-uploader-validation-message\").remove();\r\n\t};\r\n\t\r\n\tthis.startUpload = function () {\r\n\t\t \r\n\t\t// get rid of any old messages\r\n\t\t$(\"#file-uploader-validation-message\").remove();\r\n\t\t\r\n\t\t// validate - at least one file is needed for uploads\r\n\t\tif(null === this.fileUploadData ||\t!this.fileUploadData.files.length){\r\n\t\t\tthis.prependAertMessage(ap.core_prompts[\"prompt.Template.SelectAFile\"]);\t\t\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t// does any of the files have errors ?\r\n\t\tif (this.fileUploadData.files.filter( \r\n\t\t\t\tfunction (file) { return file.error; }).length ){\r\n\t\t\t\r\n\t\t\tthis.prependAertMessage(ap.core_prompts[\"prompt.Template.FixErrors\"]);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\t// disable the buttons before file transmission\r\n\t\t$(\"#file-uploader-widget button\").attr(\"disabled\", true);\r\n\t\t\r\n\t\tthis.fileUploadData.submit(); \r\n\t\t// enable the buttons back . \r\n\t\t$(\"#file-uploader-widget button\").attr(\"disabled\", false);\r\n\t};\r\n\t\r\n\t\r\n\t/**\r\n\t * Create work items and associate with <b>NEW</b> account \r\n\t * Account ID sent to back end is -1. \r\n\t */\r\n\tthis.createWorkItemsAndAccount = function(){\r\n    \t\r\n    \tvar $self = this;\r\n    \t\r\n    \t$self.addProgressIndicatorSpinner($('#turnstile-account-selector button.new-account'));\r\n    \t$('#turnstile-account-selector button').attr(\"disabled\", \"disabled\");\r\n    \t\r\n\t\t// provide call back to hide the modal\r\n\t\tthis.createWorkItems(function(){ \r\n\t\t\t\r\n\t\t\t$self.removeSpinnerControl($('#turnstile-account-selector button.new-account')); \r\n\t\t\t$self.resetAccountModal();\r\n\t\t\t\t$('#turnstile-account-selector').modal('hide');\r\n\t\t\t}, '-1' );\r\n\t\t\t\t\r\n\t};\r\n\t\r\n\t/**\r\n\t * Create work itmes with account \r\n\t * @param accountId the account id that is used to associate the work items that are created.  \r\n\t */\r\n\tthis.createWorkItemsWithAccount = function(accountId){\r\n\r\n\t\tvar $self = this;\r\n     \r\n    \t$('#turnstile-account-selector button').attr(\"disabled\", \"disabled\");\r\n    \t\r\n\t\t// provide call back to hide the modal\r\n\t\tthis.createWorkItems(function(){ \r\n\t\t\t$self.resetAccountModal();\r\n\t\t\t\t$('#turnstile-account-selector').modal('hide');\r\n\t\t\t}, accountId );\r\n\t\t\r\n\t};\r\n\t\r\n\t\r\n\tthis.resetAccountModal = function () {\r\n\t\tthis.removeSpinnerControl($('#turnstile-account-selector button.new-account'));\r\n    \t$('#turnstile-account-selector button.account-search-button').removeClass('active');\r\n\t\t$('#turnstile_account_searchInput').val('');\r\n\t\t$('#turnstile-account-search').addClass('hidden');\r\n\t\t$('#turnstile-account-selector button').removeAttr(\"disabled\");\r\n\t\t\r\n\t};\r\n\t\r\n\t/**\r\n\t * Create work Items without accounts. \r\n\t */\r\n\tthis.continueWithoutAccount = function () {\r\n\t\t//Add a spinner .. \r\n\t\tvar $self = this;\r\n\t\t\r\n\t\t$self.addProgressIndicatorSpinner($('#turnstile-account-selector button.no-account'));\r\n    \t\r\n     \t$('#turnstile-account-selector button').attr(\"disabled\", \"disabled\");\r\n    \t\r\n\t\t// provide call back to hide the modal\r\n\t\tthis.createWorkItems(function(){ \r\n\t\t\t$self.removeSpinnerControl($('#turnstile-account-selector button.no-account'));\r\n\t\t\t\t$self.resetAccountModal();\r\n\t\t\t\t$('#turnstile-account-selector').modal('hide');\r\n\t\t\t} );\r\n\t};\r\n\t\r\n\t/**\r\n\t * Create Workitems without an account. \r\n\t * GUID and Transaction list is retrieved from hidden LOB modal.\r\n\t * @param callback the call back function to be executed on done \r\n\t * @param accountId - the account ID to which the work items created are to be attached, \r\n\t * \t\t\taccountId -> undefined => createWorkitems without account\r\n\t * \t\t\taccountId -> -1        => Create a new Account and associate the work items to that account.\r\n\t * \t\t\taccountId -> ####      => Create new work items and attach to the account identified by account id.\r\n\t */\r\n\tthis.createWorkItems = function( callback , accountId){\r\n\t\t\r\n\t\tvar action = (accountId === undefined) ?  'createworkitems':'createworkitemsandaccount';\r\n\t\t\r\n\t\tvar accId = (accountId === undefined) ? '' : accountId ;\r\n\r\n\t\t$(\"#turnstile-processed-lob-listing\").html(\"\");\r\n\t\t$(\"#turnstile-processed-message\").html(\"\");\r\n\t\t\t\t\r\n\t\tvar guid = $('#turnstile-stage-guid').val();\r\n\t\tvar tranactions =  [];\r\n\t\t\r\n\t\tvar $self = this; \r\n\t \t\r\n\t\t$('input[name=\"transactions\"]:checked').map(function(){return tranactions.push(this.value);});\r\n\t\t\r\n\t       $.ajax({\r\n\t            type: \"POST\",\r\n\t            url: turnstileServiceURL,\r\n\t            dataType: \"JSON\",\r\n\t            data: {\r\n\t                'requestType': action,\r\n\t                'guid': guid,\r\n\t                'transactions': tranactions.join(\",\"),\r\n\t                'accountid':accId\r\n\t            }\r\n\t        }).done(function (msg) {\r\n\t        \t\r\n\t        \tif(callback && typeof callback === 'function' ){\r\n\t        \t\tcallback();\r\n\t        \t}\r\n\t        \tif(msg.code === \"LobNotFound\"){\r\n\t        \t\t $('#lob-validation-message').html(msg.message);\r\n\t\t        \t $('#lob-validation-message').show();\r\n\t\t        \t $('#turnstile-lob-selector ').modal('show');\r\n\t\t        \t  \r\n\t        \t}\r\n\t        \telse{\r\n\t        \t \t$self.renderWorkitemsList(msg);\r\n\t\t        \t$self.showUploadStatus();\t  \r\n\t\t        \t$('#turnstile-lob-selector .alert-danger').hide()\r\n\t        \t}\r\n\t        \t\r\n\t            \t\r\n\t        }).fail(function (msg){\r\n\t        \t\r\n\t        \tif(callback && typeof callback === 'function' ){\r\n\t        \t\tcallback();\r\n\t        \t}\r\n\t        \t \r\n\t        \t$('#turnstile-error-modal .alert-danger').html(msg.responseJSON.message);\r\n\t        \t$('#turnstile-error-modal').modal('show');\r\n\t        \t\r\n\t        \t$self.showUploadStatus();\r\n\t        \t\r\n\t       });\r\n\t};\r\n\t/**\r\n\t * Counts number of workitems in the processed list.\r\n\t */\r\n\tthis.countWorkItems = function(msg) {\r\n\t\tvar workItemCount = 0;\r\n\t\tmsg.workitems.forEach( function (item){\r\n\t\t\tworkItemCount++;\r\n\t\t});\r\n\t\treturn workItemCount;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Count number of errors in workitems list allowing to change message accordingly.\r\n\t */\r\n\tthis.countErrors = function (msg) {\r\n\t\tvar count = 0;\r\n\t\tmsg.workitems.forEach( function (item) {\r\n\t\t\tif( item.status === 'Error'){\r\n\t\t\t\tcount++;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn count;\r\n\t};\r\n\t/**\r\n\t * Render a work items list post the TS processing and creating the workitems in the system\r\n\t */\r\n\tthis.renderWorkitemsList = function ( msg ){\r\n    \t\r\n\t\tvar account = msg.workitems.filter( function (item ){ return item.lobCd === 'ACCOUNT';});\r\n\t\tvar errorCount = this.countErrors(msg);\r\n\t\tvar workItemCount = this.countWorkItems(msg);\r\n\t\tif(account.length){\r\n\t\t\t//Account creates an additional workitem not looking for errors in the account. Therefore decrementing the workitem count by 1 in account scenarios.\r\n\t\t\tworkItemCount = --workItemCount;\r\n\t\t\tif( errorCount === workItemCount){\r\n\t\t\t\taccountMessageTemplate = accountMessageTemplate.replace(\"{{message}}\", ap.core_prompts[\"message.Turnstile.message.submittedUnSuccesfulToAccount\"]);\r\n\t\t\t\t$(\"#turnstile-processed-message\").append(\r\n\t\t\t\t\t\taccountMessageTemplate.split(\"{{accountName}}\").join(account[0].entityName + \" #\"+account[0].workitemid)\r\n\t\t\t\t\t\t.split(\"{{url}}\").join(account[0].url)\r\n\t\t\t\t\t\t);\r\n\t\t\t}\r\n\t\t\telse if(errorCount > 0){\r\n\t\t\t\taccountMessageTemplate = accountMessageTemplate.replace(\"{{message}}\", ap.core_prompts[\"message.Turnstile.message.submittedSuccesfulToAccountWithError\"]);\r\n\t\t\t\t$(\"#turnstile-processed-message\").append(\r\n\t\t\t\t\t\taccountMessageTemplate.split(\"{{accountName}}\").join(account[0].entityName + \" #\"+account[0].workitemid)\r\n\t\t\t\t\t\t\t\t\t\t\t  .split(\"{{url}}\").join(account[0].url)\r\n\t\t\t\t\t\t);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\taccountMessageTemplate = accountMessageTemplate.replace(\"{{message}}\",ap.core_prompts[\"message.Turnstile.message.submittedSuccesfulToAccount\"]);\r\n\t\t\t\t$(\"#turnstile-processed-message\").append(\r\n\t\t\t\t\t\taccountMessageTemplate.split(\"{{accountName}}\").join(account[0].entityName + \" #\"+account[0].workitemid)\r\n\t\t\t\t\t\t\t\t\t\t\t  .split(\"{{url}}\").join(account[0].url)\r\n\t\t\t\t\t\t);\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tif(errorCount === workItemCount){\r\n\t\t\t\t$(\"#turnstile-processed-message\").html(ap.core_prompts[\"message.Turnstile.message.submittedUnSuccesfulNoAccount\"]);\r\n\t\t\t}\r\n\t\t\telse if (errorCount > 0) {\r\n\t\t\t\t$(\"#turnstile-processed-message\").html(ap.core_prompts[\"message.Turnstile.message.submittedSuccesfulNoAccountWithError\"]);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\t$(\"#turnstile-processed-message\").html(ap.core_prompts[\"message.Turnstile.message.submittedSuccesfulNoAccount\"]);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif($(\"#open-acct-button\") != null){\r\n\t\t\t$(\"#open-acct-button\").remove();\r\n\t\t}\r\n\t\tmsg.workitems.forEach( function (item) {\r\n    \t\t\r\n\t\t\tif( 'ACCOUNT' !=  item.lobCd) {\r\n\t\t\t\r\n\t    \t\tvar wiId = item.workitemid;\r\n\t    \t\tif(item.status ==='Error'){\r\n\t    \t\t\twiId = '<i class=\"fa fa-exclamation-triangle\" ></i>';\r\n\t    \t\t\t$(\"#turnstile-processed-lob-listing\").append(\r\n\t    \t\t\t\t\twiListRowTemplateError.split(\"{{workItemId}}\").join( wiId )\r\n\t        \t\t\t\t\t\t .split(\"{{lobTitle}}\").join(item.lobDesc)\r\n\t        \t\t\t\t\t\t .split(\"{{styleClass}}\").join(\"danger\")\r\n\t        \t\t\t\t\t\t .split(\"{{error}}\").join(item.message));\t    \r\n\t    \t\t}else{\r\n\t\t    \t\tvar url = '<a href=\"' + item.url +'\"' +  'class=\"btn btn-primary pull-right\"' + 'target=\"_self\" >' + ap.core_prompts[\"action.Open\"] + '</a>' ;  \t    \t\t\r\n\t    \t\t\t$(\"#turnstile-processed-lob-listing\").append(\r\n\t    \t\t\t\t\twiListRowTemplate.split(\"{{workItemId}}\").join( wiId )\r\n\t        \t\t\t\t\t\t .split(\"{{lobTitle}}\").join(item.lobDesc)\r\n\t        \t\t\t\t\t\t .split(\"{{styleClass}}\").join(\"\")\r\n\t        \t\t\t\t\t\t .split(\"{{url}}\").join(url));\t    \t\t\r\n\t    \t\t}\t    \t\t\r\n\t\t\t}\r\n    \t\t \r\n    \t});\r\n\r\n\t\t$(\"#turnstile-processed-lob-listing\").find('[data-toggle=\"popover\"]').each(function () {\r\n            $(this).popover('show');\r\n            $(this).popover('hide');\r\n        });\r\n\t\t\r\n\t\t$('#turnstile-workitem-selector').modal('show');\r\n\t\t$('#turnstile-workitem-selector').on('hidden.bs.modal', function (e) {\r\n\t\t\t\r\n\t\t\tvar url = window.location.href;\r\n\t\t\tif(url.indexOf('AccountItemsView') > -1 || url.indexOf('WorkItemsView') > -1){\r\n\t\t\t\twindow.location.reload(true);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t\r\n\t\t$('body').on('click', function (e) {\r\n\t            $('[data-toggle=\"popover\"]').each(function () {\r\n\t                if (!$(this).is(e.target) && $(this).has(e.target).length === 0 && $('.popover').has(e.target).length === 0) {\r\n\t                    $(this).popover('hide');\r\n\t                }\r\n\t            });\r\n\t    });    \t\r\n\t};\r\n\t\r\n\t/**\r\n\t * Helper function to prepend alert messages for file upload.\r\n\t */\r\n\tthis.prependAertMessage = function(message) {\r\n\t\t$(\"#file-uploader-widget\").prepend( fileUploaderAlertdivTemplate.split(\"{{message}}\").join( message ) );\t\r\n\t};\r\n\t\r\n    this.setup(arguments);\r\n\r\n};\r\n\r\n\r\n$(function () {\r\n    ap.turnstileWidget = new ap.TurnstileWidget(\"fileupload_blueimp\",\"turnstile-files-selector\");\r\n});","(function() {\n'use strict';\n\n// Declare app level module which depends on views, and components\nangular.module('ap.worklist', [\n  'ngRoute',\n  'ui.bootstrap',\n  'ap.worklist.workListViewServices',\n  'ap.worklist.workitemActionsService',\n  'ap.worklist.mdl',\n  'ap.worklist.main',\n  'ap.worklist.drv.card',\n  'ap.worklist.drv.adddNewCard',\n  'ap.common.constants',\n  'ap.worklist.queues'\n])\n\n/*\n * Register a http interceptor that will handle error at a global level for all http calls\n * Intercepts the response when http error occurs (status code between 200 and 299 is considered a success status)\n * Broadcasts (with name 'ap.messages') the error response for whoever is listening  \n */\n.config(['$provide', '$httpProvider', function($provide, $httpProvider) {\n\t$httpProvider.interceptors\n\t.push(function($q, $rootScope) {\n\t\treturn {\n\t\t\t'responseError': function(response) {\n\t\t\t\tif(response.status != 404){\n\t\t\t\t\t $rootScope.$broadcast('ap.messages', response);\n\t\t\t    }\n\t\t\t\treturn $q.reject(response);\n\t\t\t}\n\t\t};\n\t});\n}])\n\n\n/*\n * This directive listens to error messages broadcasted by the http interceptor.\n * Uses messages.tpl.jsp template to display the error messages.\n * The messages are removed after 5 secs by default with an exception of security error.\n * An error is considered security error if error code is one of the error codes defined in ap.common.constants (see site_shell.jsp) \n * When the security error is detected, the session is usually invalidated and hence \"Click here to Continue\" button is present \n * which will take the use to the Login page.\n * This directive can be engaged using <ANY messages /> or <messages />\n */\n.directive('messages',\t[ '$timeout', '$log', 'securityErrorCodes', function($timeout, $log, securityErrorCodes) {\n\tap.consoleInfo('messages directive!!!');\n\treturn {\n\t\trestrict : 'AE',\n\t\tlink : function(scope, element, attrs) {\n\t\t\tscope.messages = [];\n\t\t\tscope.hasSecurityError = false;\n\t\t\t$log.log(\"Messages directive\");\n\t\t\t\n\t\t\tscope.$on('ap.messages',function(event,eventData){\n\t\t\t\t$log.log(\"Received messages\");\n\t\t\t\tvar msg = eventData.data.response.message;\n\t\t\t\tscope.messages.splice(0, scope.messages.length);\n\t\t\t\tscope.messages.push(msg);\n\t\t\t\tconsole.log(securityErrorCodes);\n\t\t\t\tif(securityErrorCodes.indexOf(eventData.data.response.status) < 0 ){\n\t\t\t\t\tvar index = scope.messages.indexOf(msg);\n\t\t\t\t\t$timeout(function(){\n\t\t\t\t\t\tscope.messages.splice(index,1);\n\t\t\t\t\t},5000);\n\t\t\t\t}else{\n\t\t\t\t\tscope.hasSecurityError = true;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\ttemplateUrl: 'shared/partials/messages.tpl.jsp'\n\t};\n} ])\n\n.filter('percentage', ['$filter', function ($filter) {\n\t  return function (input, decimals) {\n\t\t  if (decimals && decimals.length){\n\t\t\t    return $filter('number')(input, decimals) + '%';\n\t\t  } else {\n\t\t\t    return $filter('number')(input) + '%';\n\t\t  }\n\t  };\n\t}]);\n\n})();\n\n","(function() {\n'use strict';\n\n\tangular.module('ap.worklist.workListViewServices', ['ngResource','ap.common.constants'])\n\n\t/*\n\t *Model defined as a service so it can shared by all the components \n\t */\n\t.service('model', [function WorklistModel(){\n\t\tvar model = this;\n\t\tmodel.metaData = {};\n\t\tmodel.workItems = {};\n\t\tmodel.pagination = {};\n\t\tmodel.cleanMetaData = {\n\t\t\t\tworklist_metaData: {},\n\t\t\t\taccount_metaData: {}\n\t\t};\n\t\tmodel.lookuplist = {};\n\t\tmodel.loading = false;\n\t\t\n\t}])\n\t\n\t/*\n\t * This service is responsible for all the rest call to the worklist api\n\t * model is the model service which is the container for model objects\n\t * contextPath is the constant for the contextpath defined in ap.common.constants\n\t * csrfobject is json object containing CSRF TOKEN key and value. Defined in ap.common.constants\n\t */\n\t.service('WorkListViewSrv', ['model','$resource', '$filter', 'contextPath','csrfObject', '$log', \n\t                             \tfunction(model, $resource, $filter, contextPath, csrfObject, $log){\n\t\t$log.log('created WorkListViewSrv');\n\t\tvar self = this;\n\n\t\t/*\n\t\t * This is map containing parameter values to be used for REST calls keyed by worklist urls\n\t\t */\n\t\tself.urls = {\n\t\t\t\tWorkItemsView: {listId: 'WorkItemsView', worklistType: 'workitems'  },\n\t\t\t\tAccountItemsView: {listId: 'AccountItemsView', worklistType: 'workitems'  },\n\t\t\t\tAccountsView: {listId: 'AccountsView', worklistType: 'accounts' },\n\t\t\t\tworklist: {listId: 'WorkItemsView', worklistType: 'workitems'  },\n\t\t\t\taccount: {listId: 'AccountsView', worklistType: 'accounts' }\n\t\t};\n\t\t\n\t\t/*\n\t\t * Parameters map used in by the rest calls \n\t\t */\n\t\tvar wlResParams = { worklistType:'@worklistType', listId: '@listId', views: 'views', csrftokenname: '@csrftokenname', \n\t\t\t\t\t\t\tcsrftoken: '@csrftoken', saved_search_id: 'saved_search_id', searchName: '@searchName'};\n\t\t\n\t\t/*\n\t\t * WorklistResources definition \n\t\t */\n\t\tself.worklistResource = \n\t\t $resource(contextPath + '/api/worklists/:worklistType/:views/:listId?:csrftokenname=:csrftoken&:saved_search_id=:searchName' , {},{\n\t\t\tgetmetadata: {method:'GET', params: wlResParams, isArray:false, headers: { Accept: 'application/json' } },\n\t\t\tquery: {method:'POST', params: wlResParams, isArray:false, headers: { Accept: 'application/json', 'Content-Type': 'application/json' }},\n\t\t\tsave: {method:'PUT', params: wlResParams, isArray:false, headers: { Accept: 'application/json', 'Content-Type': 'application/json' }},\n\t\t\tremove: {method:'DELETE', params: wlResParams, isArray:false, headers: { Accept: 'application/json', 'Content-Type': 'application/json' }}\n\t\t});\n\n\t\t/*\n\t\t * NewWorkitem Links Resource definition\n\t\t */\n\t\tself.newWorkItemLinksResource = \n\t\t\t $resource(contextPath + '/api/lookups/basic/NewWorkItemLink?:csrftokenname=:csrftoken',{},{\n\t\t\t\tquery: {method:'GET', params: { work_item_type:'@worklistType', csrftokenname: '@csrftokenname', csrftoken: '@csrftoken'}, isArray:false, headers: { Accept: 'application/json' }}\n\t\t});\n\n\t\t\n\t\t/*\n\t\t * Set csrf token value after each service call.\n\t\t */\n\t\tself.setCSRFToken = function(headers){\n\t\t\tcsrfObject.csrftokenValue = headers(csrfObject.csrftokenName);\n\t\t\tcsrfObject.tokenobj[csrfObject.csrftokenName] = csrfObject.csrftokenValue;\n\t\t};\n\n\t\t/*\n\t\t * Retrieve lookup lists for the lookup url in the metadata\n\t\t */\n\t\tself.retrieveLookupList = function(lookupLinks,paramsObj){\n\t\t\tangular.forEach(lookupLinks,function(link){\n\t\t\t\tvar realmComponentArray = link.rel.split(\".\");\n\t\t\t\tvar type = realmComponentArray[realmComponentArray.length-1];\n\t\t\t\tvar params = {};\n\t\t\t\tif(paramsObj){\n\t\t\t\t\tparams = angular.extend(paramsObj,csrfObject.tokenobj);\n\t\t\t\t}else{\n\t\t\t\t\tvar worklistType = self.getParameterByName('WorkListType');\n\t\t\t\t\tparams = angular.extend(self.urls[worklistType],csrfObject.tokenobj);\n\t\t\t\t}\n\t\t\t\t$resource(contextPath + link.href,params,{\n\t\t\t\t\tget: {method:'GET', headers: { Accept: 'application/json' }}\n\t\t\t\t})\n\t\t\t\t.get(function(data,headers){\n\t\t\t\t\tself.setCSRFToken(headers);\n\t\t\t\t\tmodel.lookuplist[type] = data.response.results.codeList.codes;\n\t\t\t\t});\t\t\t\t\t\n\t\t\t});\n\t\t};\n\t\t\n\t\t/*\n\t\t * Get title/description for given code and list type\n\t\t */\n\t\tself.lookupValue = function(type,code){\n\t\t\tvar retVal = code;\n\t\t\tangular.forEach(model.lookuplist[$filter('uppercase')(type)],function(option){\n\t\t\t\tif(option.value == code){\n\t\t\t\t\tretVal = option.title;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn retVal;\n\t\t};\n\t\t\n\t\t/*\n\t\t * Get the content for advanced search using the url in the metadata\n\t\t */\n\t\tself.getAdvancedSearch = function(){\n\t\t\tvar queryInfoLinks = model.metaData.queryInfo.links;\n\t\t\tvar dialogResUrl = null;\n\t\t\tangular.forEach(queryInfoLinks, function(link) {\n\t\t\t\tif(link.rel == 'dialog-resource'){\n\t\t\t\t\tdialogResUrl = link.href;\n\t\t\t\t}\n\t\t\t });\n\t\t\tif(dialogResUrl != null){\n\t\t\t\tvar getList = function(){\n\t\t\t\t\t\n\t\t\t\t\t$log.log(\"Getting optionslist for advanced search operators\");\n\t\t\t\t\tangular.forEach(model.metaData.queryInfo.pages[0].sections[0].fields,function(field){\n\t\t\t\t\t\tif(field.type == 'selectlist'){\n\t\t\t\t\t\t\tif(field.name == 'operator'){\n\t\t\t\t\t\t\t\tvar effDtField = $filter('filter')(model.metaData.queryInfo.pages[0].sections[0].fields, {type: 'date'});\n\t\t\t\t\t\t\t\tif(effDtField.length){\n\t\t\t\t\t\t\t\t\teffDtField[0].selectedOperator = field.defaultValue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tangular.forEach(field.optionLists,function(optionlist){\n\t\t\t\t\t\t\t\t$log.log('query operators= ' + optionlist.link.href);\n\t\t\t\t\t\t\t\t$resource(contextPath + optionlist.link.href,csrfObject.tokenobj,{\n\t\t\t\t\t\t\t\t\tget: {method:'GET', headers: { Accept: 'application/json' }}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.get(function(data,headers){\n\t\t\t\t\t\t\t\t\tself.setCSRFToken(headers);\n\t\t\t\t\t\t\t\t\tfield.options = data.response.results.optionList.optionEntries;\n\t\t\t\t\t\t\t\t\tfield.selectedOption = field.defaultValue;\n\t\t\t\t\t\t\t\t\t$log.log(field);\n\t\t\t\t\t\t\t\t},function(data){\n\t\t\t\t\t\t\t\t\t$log.log('Unable to retrieve valid meta data for worklist : ' + data);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t};\n\t\t\t\t$log.log('query page = ' + dialogResUrl);\n\t\t\t\t$resource(contextPath + dialogResUrl,csrfObject.tokenobj,{\n\t\t\t\t\tget: {method:'GET', headers: { Accept: 'application/json' }}\n\t\t\t\t})\n\t\t\t\t.get(function(data,headers){\n\t\t\t\t\tself.setCSRFToken(headers);\n\t\t\t\t\tqueryInfoLinks.content = {};\n\t\t\t\t\tqueryInfoLinks.content.pageId = model.metaData.queryInfo.pageId;\n\t\t\t\t\tmodel.metaData.queryInfo.pages = [];\n\t\t\t\t\tmodel.metaData.queryInfo.pages.push(data.response.results.page);\n\t\t\t\t\t$log.log(model.metaData.queryInfo);\n\t\t\t\t\tgetList();\n\t\t\t\t},function(data){\n\t\t\t\t\t$log.log('Unable to retrieve valid meta data for worklist : ' + data);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\t\n\t\t/*\n\t\t * Save search options selected this far.\n\t\t */\n\t\tself.saveSearch = function(searchName, resHandler){\n\t\t\t\t\n\t\t\tvar type = self.getParameterByName('WorkListType');\n\t\t\tvar searNameParam = -1;\n\t\t\tif(searchName != null){\n\t\t\t\tsearNameParam = searchName;\n\t\t\t}\n\t\t\tvar par = angular.extend({csrftokenname: csrfObject.csrftokenName, csrftoken: csrfObject.csrftokenValue, searchName : searNameParam},self.urls[type],model.metaData);\n\t\t\t$log.log(par);\n\t\t\tself.worklistResource.save(par, function(data,headers){\n\t\t\t\tif (data.response.status === 0) {\n\t\t\t\t\tself.setCSRFToken(headers);\n\t\t\t\t\tif(angular.isFunction(resHandler)){\n\t\t\t\t\t\tresHandler(data);\n\t\t\t\t\t}\n\t\t        } else {\n\t\t        \t$log.log('Unable to retrieve valid meta data for worklist : ' + data.response.message);\n\t\t        }\n\t\t\t});\n\t\t};\n\t\t\n\t\t/*\n\t\t * Delete the selected search entry selected\n\t\t */\n\t\tself.deleteSearch = function(searchId, resHandler){\n\t\t\tvar worklistType = self.getParameterByName('WorkListType');\n\t\t\tvar par = angular.extend({csrftokenname: csrfObject.csrftokenName, \n\t\t\t\tcsrftoken: csrfObject.csrftokenValue, searchName : searchId},self.urls[worklistType]);\n\n\t\t\tself.worklistResource.remove(par,function(data,headers){\n\t\t\t\t self.setCSRFToken(headers);\n\t\t\t\t if(angular.isFunction(resHandler)){\n\t\t\t\t\t resHandler();\n\t\t\t\t }\n\t\t\t},function(data){\n\t\t\t\t$log.log('Unable to delete saved search : ' + data);\n\t\t\t});\n\t\t};\n\t\t\n\t\t/*\n\t\t * Get metadata for the worklist view based on the URL path param\n\t\t */\n\t\tself.getMetaData = function(worklistType, searchName, resHandler){\n\t\t\tvar searNameParam = searchName;\n\t\t\tif(searchName == null){\n\t\t\t\tsearNameParam = searchName;\n\t\t\t}\n\t\t\tvar par = angular.extend({csrftokenname: csrfObject.csrftokenName, \n\t\t\t\t\t\t\t\tcsrftoken: csrfObject.csrftokenValue, searchName : searNameParam},self.urls[worklistType]);\n\t\t\t\n\t\t\tself.worklistResource.getmetadata(par,function(data,headers){\n\t\t\t\t self.setCSRFToken(headers);\n\t\t\t\t model.metaData = data.response.results.workListView;\n\t\t\t\t angular.forEach(model.metaData.listViews,function(view){\n\t\t\t\t\tif(view.selected == true){\n\t\t\t\t\t\tmodel.pagination.viewPortSize = view.viewPortSize;\n\t\t\t\t\t\tmodel.pagination.startRowNumber = view.startRowNumber;\n\t\t\t\t\t\tmodel.pagination.fetchSize = view.fetchSize;\n\t\t\t\t\t} \n\t\t\t\t });\n\t\t\t\t \n\t\t\t\t self.getNewWorkItemLinks(worklistType);\n\t\t\t\t self.getAdvancedSearch();\n\t\t\t\t if(angular.isFunction(resHandler)){\n\t\t\t\t\t resHandler();\n\t\t\t\t }\n\t\t\t\t},function(data){\n\t\t\t\t\t$log.log('Unable to retrieve valid meta data for worklist : ' + data);\n\t\t\t\t\t$log.log(data);\n\t\t\t});\n\t\t};\n\t\t\n\t\t/*\n\t\t * Function that performs the search initiated from modal dialog\n\t\t */\n\t\tself.performModalSearch = function(indexType, searchValue, accountIdToExclude, callback){\n\t\t\tvar metaDataCopy = angular.copy(model.cleanMetaData[indexType +'_metaData']);\n\t\t\tvar searchField = null;\n\t\t\tvar workItemField = null;\n\t\t\tangular.forEach(metaDataCopy.queryInfo.queryFields, function(queryField){\n\t\t\t\tif(queryField.relatedFieldId == 'entity_name'){\n\t\t\t\t\tsearchField = queryField;\n\t\t\t\t}else if(queryField.relatedFieldId == 'work_item_id'){\n\t\t\t\t\tworkItemField = queryField;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t});\n\t\t\t\n\t\t\t//set the search value to query field\n\t\t\tif(searchValue.length == 0){\n\t\t\t\tsearchField.operands[0] = '*';\n\t\t\t}else{\n\t\t\t\tsearchField.operands[0] = searchValue;\n\t\t\t}\n\t\t\t\n\t\t\t//set the account id to be excluded\n\t\t\tif(accountIdToExclude != null && typeof accountIdToExclude !== 'undefined'){\n\t\t\t\tworkItemField.opCode = 'NOT_EQUAL';\n\t\t\t\tworkItemField.operands[0] = accountIdToExclude;\n\t\t\t\tworkItemField.selected = true;\n\t\t\t}\n\t\t\t\n\t\t\tvar par = angular.extend({},self.urls[indexType],{csrftokenname: csrfObject.csrftokenName, csrftoken: csrfObject.csrftokenValue},metaDataCopy);\n\t\t\t$log.log(par);\n\t\t\tself.worklistResource.query(par, function(data){\n\t\t\t\tif (data.response.status === 0) {\n\t\t\t\t\t$log.log(\"fetched workitems. count: \" + data.response.results.docs.length);\n\t\t\t\t\tcallback(data);\n\t\t        } else {\n\t\t        \t$log.log('Unable to retrieve valid meta data for worklist : ' + data.response.message);\n\t\t        }\n\t\t\t});\t\t\t\n\t\t};\n\t\t\n\t\t\n\t\t\n\t\t/*\n\t\t * Search for accounts or workitems \n\t\t */\n\t\tself.searchEntities = function(indexType, searchValue,accountIdToExclude, callback){\n\t\t\tif(searchValue.length > 0 && searchValue.length < 3){\n\t\t\t\treturn; //no ops. we search only when 3 chars are entered\n\t\t\t}\n\t\t\t //make a copy that can used for search modals.\n\t\t\t //We should save a clean copy before user makes changes\n\t\t\tif(model.cleanMetaData[model.metaData.index +'_metaData'].index != indexType){\n\t\t\t\tvar par = angular.extend({csrftokenname: csrfObject.csrftokenName, csrftoken: csrfObject.csrftokenValue},self.urls[indexType]);\n\t\t\t\tself.worklistResource.getmetadata(par,function(data,headers){\n\t\t\t\t\t self.setCSRFToken(headers);\n\t\t\t\t\t model.cleanMetaData[indexType +'_metaData'] = data.response.results.workListView;\n\t\t\t\t\t $log.log(model.cleanMetaData[indexType +'_metaData']);\n\t\t\t\t\t return self.performModalSearch(indexType, searchValue,accountIdToExclude, callback);\n\t\t\t\t\t},function(data){\n\t\t\t\t\t$log.log('Unable to retrieve valid meta data for worklist : ' + data);\n\t\t\t\t});\n\t\t\t}else{\n\t\t\t\treturn self.performModalSearch(indexType, searchValue,accountIdToExclude, callback);\n\t\t\t}\n\t\t\t \n\t\t};\n\t\t\n\t\t/*\n\t\t * Get workitems based on the search options selected\n\t\t */\n\t\tself.getWorkItems = function(resHandler){\n\t\t\tvar type = self.getParameterByName('WorkListType');\n\t\t\tvar par = angular.extend({csrftokenname: csrfObject.csrftokenName, csrftoken: csrfObject.csrftokenValue},self.urls[type],model.metaData);\n\t\t\t$log.log(par);\n\t\t\tself.worklistResource.query(par, function(data,headers){\n\t\t\t\tif (data.response.status === 0) {\n\t\t\t\t\t$log.log(\"fetched workitem \");\n\t\t\t\t\tself.setCSRFToken(headers);\n\t\t\t\t\tmodel.workItems = data.response.results.docs;\n\t\t\t\t\tmodel.pagination.startRowNumber = data.response.results.start;\n\t\t\t\t\tmodel.pagination.total = data.response.results.hits;\n\t\t\t\t\tmodel.pagination.currentPage = 1;\n\t\t\t\t\t$log.log(model.workItems);\n\t\t\t\t\t$log.log(model.pagination);\n\t\t\t\t\tif(angular.isFunction(resHandler)){\n\t\t\t\t\t\tresHandler(data);\n\t\t\t\t\t}\n\t\t        } else {\n\t\t        \t$log.log('Unable to retrieve valid meta data for worklist : ' + data.response.message);\n\t\t        }\n\t\t\t});\n\t\t};\n\t\t\n\t\t/*\n\t\t * Get workitem links for the worklist type (workitem/account)\n\t\t */\n\t\tself.getNewWorkItemLinks = function(worklistType){\n\t\t\tvar wid = self.getParameterByName('WORKITEMID');\n\t\t\tvar par = angular.extend({csrftokenname: csrfObject.csrftokenName, csrftoken: csrfObject.csrftokenValue},self.urls[worklistType]);\n\t\t\tif(wid.length > 0){\n\t\t\t\tpar[\"WORKITEMID\"] = wid;\n\t\t\t}\n\t\t\tself.newWorkItemLinksResource.query(par,function(data,headers){\n\t\t\t\t self.setCSRFToken(headers);\n\t\t\t\t model.metaData.newWorkItemLinks = data.response.results.codeList.codes;\n\t\t\t\t $log.log(\"New Workitem links\");\n\t\t\t\t $log.log(model.metaData.newWorkItemLinks);\n\t\t\t\t},function(data){\n\t\t\t\t$log.log('Unable to retrieve valid meta data for worklist : ' + data);\n\t\t\t});\t\t\t\n\t\t};\n\t\t\n\t\t/*\n\t\t * Utility function used to parse the path param\n\t\t */\n\t\tself.getParameterByName = function(name) {\n\t\t    name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\n\t\t    var regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\"),\n\t\t        results = regex.exec(location.search);\n\t\t    return results === null ? \"\" : decodeURIComponent(results[1].replace(/\\+/g, \" \"));\n\t\t};\n\t\t\n\t}]);\n\t\n})();","(function() {\n\n'use strict';\n\nangular.module('ap.worklist.main', ['ngRoute', 'ui.bootstrap', 'ap.worklist.workListViewServices','ap.common.constants'])\n\n.config([ '$routeProvider', function($routeProvider) {\n  //$log.log('Created ap.worklist.main:config');\n  $routeProvider.when('/CARD', {\n    templateUrl: 'worklist/partials/cardView.jsp',\n    reloadOnSearch: false\n  })\n  .when('/TABULAR',{\n\t  templateUrl:'worklist/partials/tabularView.jsp',\n\t  reloadOnSearch: false\n  })\n  .otherwise({redirectTo: '/CARD'});\n  \n }\n\n])\n\n/*\n * ap.worklist.worklistViewCtrl is first controller that paints the worklist.\n * It initiates query for worklist meta data\n * Paints the worklist search options\n */\n.controller('ap.worklist.worklistViewCtrl', ['$filter','$location', '$modal', 'WorkListViewSrv','model', '$log', 'dateFormat',\n                                             \tfunction($filter, $location, $modal, WorkListViewSrv,model, $log, dateFormat) {\n\t$log.log('created ap.worklist.worklistViewCtrl:controller');\n\tvar self = this;\n\t\n\tself.workListModel = model;\n\tself.advancedDropDown = {isopen: false};\n\tself.sortByStatus = {isOpen: false };\n\tself.searchValue = \"\"; \n\tself.searchField = {};\n\tself.savedSearchName = null;\n\tself.currentSearchName = -1;\n\n\n\t/*\n\t * Performs any initial setup needed after the meta-data is retrieved.\n\t * This function is called after the initial meta for worklist is retrieved\n\t * initView will setup any state default values for painting the UI\n\t * @param data is the response object from the getMetaData Service call.\n\t */\n\tself.initView = function(data){\n\t\tangular.forEach(self.workListModel.metaData.listViews, function(listview){\n\t\t\t$log.log('List view '+ listview.type + \", selected: \" + listview.selected);\n\t\t\tif(listview.selected == true){\n\t\t\t\t$log.log('redirecting to: ' + listview.type);\n\t\t\t\t$location.path('/' + listview.type);\n\t\t\t}\n\t\t});\n\t\t\n\t\tvar allFilters = self.workListModel.metaData.filters;\n\t\tvar status = WorkListViewSrv.getParameterByName('status');\n\t\t//If the request has originated from the quote boxes.\n\t\t//We need to clear all filters and set the status to status on request\n\t\tif(status != null && status.length > 0 && angular.equals(self.workListModel.workItems, {})){\n\t\t\t\n\t\t\t//Clear all filters\n\t\t\tvar allFilters = self.workListModel.metaData.filters;\n\t\t\t\n\t\t\tangular.forEach(allFilters, function(each){\n\t\t\t\tangular.forEach(each.filterOptions,function(filterOption){\n\t\t\t\t\tfilterOption.selected = false;\n\t\t\t\t});\n\t\t\t});\n\t\t\t//reset the query fields\n\t\t\tangular.forEach(self.workListModel.metaData.queryInfo.queryFields, function(each){\n\t\t\t\tif(each.interactive == true){\n\t\t\t\t\teach.selected = false;\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\t//set the status filter to whats on the request\n\t\t\tangular.forEach(allFilters, function(each){\n\t\t\tif(each.type == 'STATUS'){\n\t\t\t\tangular.forEach(each.filterOptions,function(option){\n\t\t\t\t\tif(option.value == status){\n\t\t\t\t\t\toption.selected = true;\n\t\t\t\t\t}else{\n\t\t\t\t\t\toption.selected = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\t\t\n\t\t\n\t\tWorkListViewSrv.retrieveLookupList(self.workListModel.metaData.lookupLinks,null);\n\t\t\n\t\t$log.log(self.workListModel);\n\n\t\t//If this is a worklist under an account, we only display workitem associated with that account.\n\t\t//Set the account filter\n\t\tvar accountId = WorkListViewSrv.getParameterByName('WORKITEMID');\n\t\tangular.forEach(self.workListModel.metaData.queryInfo.queryFields, function(queryField){\n\t\t\tif(queryField.relatedFieldId == 'entity_name'){\n\t\t\t\t//identify the search field for later use.\n\t\t\t\tself.searchField = queryField;\n\t\t\t}else if(queryField.relatedFieldId == 'account_id' && accountId.length > 0){\n\t\t\t\tqueryField.selected = true;\n\t\t\t\tqueryField.operands[0] = accountId;\n\t\t\t\tqueryField.opCode = \"EQUALS\";\n\t\t\t}\n\t\t});\n\t\n\t\t//Fetch the workitems using the meta-data\n\t\tself.fetchWorkItems();\n\t\t$log.log(\"WorkItems\");\n\t\t$log.log(self.workListModel.workItems);\n\t};\n\t\n\t\n\t/*\n\t *Get the meta for the worklist being painted based on the parameter WorkListType \n\t */\n\tself.getMetaData = function(searchName){\n\t\tvar workListType = WorkListViewSrv.getParameterByName('WorkListType');\n\t\tvar searchNameParam = -1;\n\t\tif(searchName){\n\t\t\tsearchNameParam = searchName;\n\t\t}\n\t\tWorkListViewSrv.getMetaData(workListType, searchNameParam, self.initView);\t\t\n\t};\n\t\n\t/*\n\t * Get information required to paint links for new workitems\n\t */\n\tself.getNewWorkItemLinks = function(){\n\t\tWorkListViewSrv.getNewWorkItemLinks();\n\t};\n\t\n\t//Fectch the workitem with the meta data\n\t//The function is called when user changes any filters,search criteria\n\t//as well for the initial data load.\n\tself.fetchWorkItems = function(){\n\t\tif(self.searchValue.length > 0 && self.searchValue.length < 3){\n\t\t\treturn;\n\t\t}\n\t\tself.searchField.selected = true;\n\t\tif(self.searchValue.length == 0){\n\t\t\tself.searchField.operands[0] = '*';\n\t\t}else{\n\t\t\tself.searchField.operands[0] = self.searchValue;\n\t\t}\n\t\t\n\t\tself.clearPagination();\n\t\t\n\t\t//Save search criteria and get workitems\n\t\tif(self.workListModel.metaData.isSaveable == true){\n\t\t\tself.workListModel.metaData.savedSearchInfo.currentSearch.id = -1;\n\t\t\tself.workListModel.metaData.savedSearchInfo.currentSearch.name = null;\n\t\t\tself.saveSearch(WorkListViewSrv.getWorkItems);\n\t\t}else{\n\t\t\tWorkListViewSrv.getWorkItems(function(){\n\t\t\t\t$log.log(\"retrieved workitems\");\n\t\t\t});\n\t\t}\n\t};\n\t\n\t\n\t/*\n\t * Set the query parameters in the meta data for advanced query fields.\n\t * This is called when search button on more options is clicked.\n\t * @param pageField is the adv. search field selected on the UI\n\t */\n\tself.setAdvQueryField = function(pageField){\n\t\tangular.forEach(self.workListModel.metaData.queryInfo.queryFields, function(queryField){\n\t\t\tif(queryField.pageFieldId == pageField.name){\n\t\t\t\tif(pageField.type == 'date'){\n\t\t\t\t\tif(pageField.selectedOperator){\n\t\t\t\t\t\tqueryField.opCode = pageField.selectedOperator;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tqueryField.opCode = null;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t if(pageField.startDate){\n\t\t\t\t\t\t queryField.operands[0] = $filter('date')(pageField.startDate, dateFormat);\n\t\t\t\t\t\t queryField.selected = true;\n\t\t\t\t\t }\n\t\t\t\t\t if(pageField.selectedOperator == 'BETWEEN'){\n\t\t\t\t\t\t queryField.operands[1] = $filter('date')(pageField.endDate, dateFormat);\n\t\t\t\t\t\t queryField.selected = true;\t\t\t\t\t\t \n\t\t\t\t\t }else{\n\t\t\t\t\t\t if(queryField.operands.length > 1){\n\t\t\t\t\t\t\t queryField.operands = queryField.operands.splice(1,1);\n\t\t\t\t\t\t }\n\t\t\t\t\t }\n\t\t\t\t }else if(pageField.type == 'selectlist' && pageField.selectedOption){\n\t\t\t\t\t queryField.operands[0] = pageField.selectedOption;\n\t\t\t\t\t queryField.opCode = \"EQUALS\";\n\t\t\t\t\t queryField.selected = true;\n\t\t\t\t }else if(pageField.value){\n\t\t\t\t\t queryField.operands[0] = pageField.value;\n\t\t\t\t\t queryField.opCode = \"EQUALS\";\n\t\t\t\t\t queryField.selected = true;\n\t\t\t\t }else{\n\t\t\t\t\t if(queryField.interactive == true){\n\t\t\t\t\t\t queryField.selected = false;\n\t\t\t\t\t }\n\t\t\t\t }\n\t\t\t\treturn;\n\t\t\t}\n\t\t});\n\t};\n\n\t/*\n\t * Validate more options search input.\n\t * This function validates date fields based on the date operator  \n\t */\n\tself.validateAdvSearch = function(){\n\t\t$log.log(\"Validating adv search\");\n\t\tself.invalidAdvSearch = false;\n\t\tangular.forEach(self.workListModel.metaData.queryInfo.queryFields, function(queryField){\n\t\t\tif(queryField.selected && queryField.dataType == 'DATE'){\n\t\t\t\t\n\t\t\t\tif(queryField.opCode == 'BETWEEN' && queryField.operands.length < 2){\n\t\t\t\t\tself.invalidAdvSearch = true;\n\t\t\t\t}else if(queryField.opCode == null && queryField.operands.length > 0){\n\t\t\t\t\tself.invalidAdvSearch = true;\n\t\t\t\t}else if(queryField.opCode != null && queryField.operands.length == 0){\n\t\t\t\t\tself.invalidAdvSearch = true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn self.invalidAdvSearch;\n\t};\n\t\n\t/*\n\t * Gets workitems for the selected adv search criteria.\n\t * Called when the user clicked search on the more options\n\t */\n\tself.advanceSearchClicked = function(){\n\t\t$log.log(\"perform adv search\");\n\t\tangular.forEach(self.workListModel.metaData.queryInfo.pages[0].sections[0].fields, function(pageField){\n\t\t\tself.setAdvQueryField(pageField);\n\t\t});\n\t\t\n\t\tself.validateAdvSearch();\n\t\t\n\t\tif(!self.invalidAdvSearch){\n\t\t\tself.advancedDropDown.isopen = false;\n\t\t\tself.fetchWorkItems();\n\t\t}else{\n\t\t\t$log.log(\"Invalid advanced search!!!\");\n\t\t}\n\t};\n\t\n\t/*\n\t * Save the currently selected search criteria against entered search name\n\t */\n\tself.saveSearchClicked = function(){\n\t\tself.saveError = false;\n\t\tif(self.savedSearchName.length == 0){\n\t\t\tself.saveError = true;\n\t\t\treturn;\n\t\t}\n\t\tangular.forEach(self.workListModel.metaData.queryInfo.pages[0].sections[0].fields, function(pageField){\n\t\t\tself.setAdvQueryField(pageField);\n\t\t});\n\t\t\n\t\tself.validateAdvSearch();\n\t\tif(!self.invalidAdvSearch){\n\t\t\tself.advancedDropDown.isopen = false;\n\t\t\tself.workListModel.metaData.savedSearchInfo.currentSearch.id = -1;\n\t\t\tself.workListModel.metaData.savedSearchInfo.currentSearch.name = self.savedSearchName;\n\t\t\t\n\t\t\tvar callBackFn = function(data){\n\t\t\t\tvar currSearch = data.response.results.workListView.savedSearchInfo.currentSearch;\n\t\t\t\treturn self.retriveSavedSearch(currSearch);\n\t\t\t};\n\t\t\tself.saveSearch(callBackFn);\n\t\t}else{\n\t\t\t$log.log(\"Invalid advanced search!!!\");\n\t\t}\n\t};\n\t\n\t/*\n\t * Call the WorklistService to execute save search\n\t * @param responseHandler is the success callback handler \n\t */\n\tself.saveSearch = function(responseHandler){\n\t\tWorkListViewSrv.saveSearch(null,function(data){\n\t\t\t$log.log(\"saved search \" + self.savedSearchName);\n\t\t\t//reset the name after its been saved.\n\t\t\tself.savedSearchName = \"\";\n\t\t\tif(angular.isFunction(responseHandler)){\n\t\t\t\tresponseHandler(data);\n\t\t\t}\n\t\t});\n\t};\n\t\n\t/*\n\t * Retrieve meta data/search criteria for selected search name\n\t */\n\tself.retriveSavedSearch = function(savedSearch){\n\t\tself.workListModel.metaData.savedSearchInfo.currentSearch.id = savedSearch.id;\n\t\tself.workListModel.metaData.savedSearchInfo.currentSearch.name = savedSearch.name;\t\t\n\t\tself.getMetaData(savedSearch.id);\n\t};\n\t\n\t/*\n\t * Delete the selected search name and corresponding search criteria\n\t */\n\tself.deleteSavedSearch = function(savedSearch){\n\t\tvar modalInstance = $modal.open({\n\t\t      templateUrl: 'worklist/partials/modals/saved-filter-delete.mdl.jsp',\n\t\t      controller: 'SavedFilterDeleteCtrl',\n\t\t      resolve: {\n\t\t    \t  savedSearch: function () {\n\t\t            return savedSearch.id;\n\t\t          },\n\t\t          getMetaData : function(){\n\t\t        \t  return self.getMetaData;\n\t\t          },\n\t\t          WorkListViewSrv : function(){\n\t\t        \t  return WorkListViewSrv;\n\t\t          }\n\t\t        }\n\t\t    });\t\t\t\t\n\t};\n\t\n\t/*\n\t * Get lob filteroption for display on the UI\n\t */\n\tself.getLOBs = function(){\n\t\tvar allFilters = self.workListModel.metaData.filters;\n\t\tvar lobsArray = [];\n\t\tfor (var index = 0; index < allFilters.length; ++index) {\n\t\t\tif(allFilters[index].name === 'lobs'){\n\t\t\t\tlobsArray.push(allFilters[index].filterOptions);\n\t\t\t}\n\t\t}\n\t\treturn lobsArray;\n\t};\n\t\n\t/*\n\t * Get queryField json object that corresponds to entity_name search field\n\t */\n\tself.getEntityNameModel = function(){\n\t\tvar fields = self.workListModel.metaData.queryInfo.queryFields;\n\t\tfor(var ix=0; ix<fields.length; ix++){\n\t\t\tif(fields[ix].relatedFieldId == \"entity_name\"){\n\t\t\t\treturn fields[ix].operands[0];\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t};\n\n\t/*\n\t * This function is called by the filter drop down when they are clicked.\n\t * The status of dropdown is toggled on model object\n\t */\n\tself.selectFilter = function(object) {\n\t\tobject.selected = true;\n\t\tself.fetchWorkItems();\n\t };\n\n\t/*\n\t * Unselect the filter option selected. This is called when 'x' is clicked on the filter bread crumbs\n\t * Clear the pagination before making a server side call to get new set of workitems.\n\t */\n\tself.clearSelected = function(object) {\n\t\tobject.selected = false;\n\t\tif(object.relatedFieldId == 'entity_name'){\n\t\t\tself.searchValue = \"\";\n\t\t}\n\t\tself.fetchWorkItems();\n\t};\n\t\t\n\t/*\n\t * Clear all filters. This function is called when user click on \"clear all\" link.\n\t * Clears the selected filter and makes a call to retrieve data for default selections \n\t */\n\t self.clearFilters = function(){\n\t\tvar allFilters = self.workListModel.metaData.filters;\n\t\t\n\t\tangular.forEach(allFilters, function(each){\n\t\t\tangular.forEach(each.filterOptions,function(filterOption){\n\t\t\t\tfilterOption.selected = false;\n\t\t\t});\n\t\t});\n\t\t//reset the query fields except entity name search\n\t\tangular.forEach(self.workListModel.metaData.queryInfo.queryFields, function(each){\n\t\t\tif(each.interactive == true && each.isSaveable == true){\n\t\t\t\teach.selected = false;\n\t\t\t}\n\t\t});\n\t\tangular.forEach(self.workListModel.metaData.sortInfo.sortOptions, function(sortOpt){\n\t\t\tsortOpt.selected = false;\n\t\t});\n\n\t\t$log.log(\"Cleared all \");\n\t\t$log.log(self.workListModel.metaData.queryInfo.queryFields);\n\t\tself.savedSearchName = null;\n\t\tif(self.workListModel.metaData.isSaveable == true){\n\t\t\tself.saveSearch(function(data){\n\t\t\t\tself.getMetaData();\n\t\t\t});\t\t\t \n\t\t}else{\n\t\t\tself.getMetaData();\n\t\t}\n\t };\n\t \n\t /*\n\t  * Clear the current pagination information.\n\t  * This is called when query,filter options have changes resulting in a call to get new set of workitems\n\t  */\n\t self.clearPagination = function(){\n\t\tself.workListModel.pagination.startRowNumber = 0;\n\t\tself.workListModel.pagination.currentPage = 1;\n\t\tangular.forEach(self.workListModel.metaData.listViews,function(view){\n\t\t\tif(view.selected == true){\n\t\t\t\tself.workListModel.pagination.viewPortSize = view.viewPortSize;\n\t\t\t\tview.startRowNumber = 0;\n\t\t\t\tself.workListModel.pagination.fetchSize = view.fetchSize;\n\t\t\t}\n\t\t});\n\t };\n\t \n\t /*\n\t  * Get the filters that have 'selected' set to true\n\t  * Utility function used by UI\n\t  */\n\t self.getSelectedFilters = function(){\n\t\tvar allFilters = self.workListModel.metaData.filters;\n\t\tvar selectedFilters = [];\n\t\tif(!allFilters){\n\t\t\treturn selectedFilters;\n\t\t}\n\t\tfor (var index = 0; index < allFilters.length; ++index) {\n\t\t\tfor(var ix =0; ix<allFilters[index].filterOptions.length; ix++){\n\t\t\t\tif(allFilters[index].filterOptions[ix].selected == true){\n\t\t\t\t\tselectedFilters.push(allFilters[index].filterOptions[ix]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn selectedFilters;\n\t };\n\n\t /*\n\t  * Get the sort options that have 'selected' set to true\n\t  * Utility function used by UI\n\t  */\n\t self.getSelectedSorts = function(){\n\t\tvar selectedSorts = [];\n\t\tvar sorts = self.workListModel.metaData.sortInfo;\n\t\tif(!sorts){\n\t\t\treturn selectedSorts;\n\t\t}\n\t\tfor (var index = 0; index < sorts.sortOptions.length; ++index) {\n\t\t\tif(sorts.sortOptions[index].selected == true){\n\t\t\t\tselectedSorts.push(sorts.sortOptions[index]);\n\t\t\t}\n\t\t}\n\t\treturn selectedSorts;\n\t };\n\t \n\t /*\n\t  * set the selected value to true for the sort option based in\n\t  * Utility function used by UI\n\t  */\n\t self.selectSortOption = function(sortOption){\n\t\tvar sorts = self.workListModel.metaData.sortInfo;\n\t\tfor (var index = 0; index < sorts.sortOptions.length; ++index) {\n\t\t\tif(sorts.sortOptions[index].relatedFieldId == sortOption.relatedFieldId && sorts.sortOptions[index].selected == true){\n\t\t\t\tsorts.sortOptions[index].ascending = !sorts.sortOptions[index].ascending;\n\t\t\t\tsorts.sortOptions[index].selected = true;\n\t\t\t}else{\n\t\t\t\tsorts.sortOptions[index].ascending = false;\n\t\t\t\tsorts.sortOptions[index].selected = false;\n\t\t\t}\n\t\t\tsortOption.selected = true;\n\t\t}\n\t\tself.fetchWorkItems();\n\t };\n\t \n\t /*\n\t  * Get the title of selected filter\n\t  * @param filterType is the unique identifier for the filter\n\t  * @param filterValue is the value of the selected filter.\n\t  */\n\t self.getFilterTitle = function(filterType, filterValue){\n\t\tvar allFilters = self.workListModel.metaData.filters;\n\t\tfor (var index = 0; index < allFilters.length; ++index) {\n\t\t\tif(allFilters[index].type == filterType){\n\t\t\t\tfor(var ix =0; ix<allFilters[index].filterOptions.length; ix++){\n\t\t\t\t\tif(allFilters[index].filterOptions[ix].value == filterValue){\n\t\t\t\t\t\treturn allFilters[index].filterOptions[ix].title;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn filterValue;\n\t };\n\t \n\t /*\n\t  * Switch between card view and tabular view.\n\t  * @param selectedView is the view object for selected made\n\t  */\n\t self.switchView = function(selectedView){\n\t\t angular.forEach(self.workListModel.metaData.listViews,function(eachView){\n\t\t\tif(selectedView.type == eachView.type){\n\t\t\t\t$log.log(\"Selected view: \" + selectedView.type);\n\t\t\t\teachView.selected = true;\n\t\t\t\tself.workListModel.pagination.viewPortSize = eachView.viewPortSize;\n\t\t\t\tself.workListModel.pagination.startRowNumber = 0;\n\t\t\t\teachView.startRowNumber = 0;\n\t\t\t\tself.workListModel.pagination.fetchSize = eachView.fetchSize;\n\t\t\t\tself.workListModel.pagination.currentPage = 1;\n\t\t\t\t$log.log(\"pagination changed to \");\n\t\t\t\t$log.log(self.workListModel.pagination);\n\t\t\t\tself.fetchWorkItems();\n\t\t\t}else{\n\t\t\t\teachView.selected = false;\n\t\t\t} \n\t\t });\n\t };\n\t \n\t /*\n\t  * \n\t  */\n\t self.open = function(fieldName, $event) {\n\t\t$event.preventDefault();\n\t\t$event.stopPropagation();\n\t\t\n\t\tself[fieldName] = true;\n\t };\n\t \n\t //Launch the application\n\t//Get the meta based on the URL parameters\n\tself.getMetaData();\n\t \n}]);\n\n\n})();","(function() {\n\n'use strict';\n\nangular.module('ap.worklist.main')\n\n/*\n * This controller is responsible for displaying the data on the worklist for all views (card/tabular).\n * It is currently referenced in cardView.jsp and tabularView.jsp\n */\n.controller('ap.worklist.worklistDataCtrl', [ '$log','$modal', '$timeout', '$filter',\n                                             'model','WorkListViewSrv', 'WorkItemActionsSrv', 'csrf', \n                      function($log, $modal, $timeout, $filter, model, WorkListViewSrv, WorkItemActionsSrv, csrf) {\n\t\n\t$log.log(\"WorklistDataCtrl is created!!!\");\n\t\n\tvar self = this;\n\t\n\tself.workListModel = model;\n\t\n\tself.loading = false; \n\t\n\t$log.log(self.workListModel.workItems);\n\t\n\tself.messages = [];\n\t\n\tself.getLobDesc = function(lobCd){\n\t\tvar allFilters = self.workListModel.metaData.filters;\n\t\tfor (var index = 0; index < allFilters.length; ++index) {\n\t\t\tif(allFilters[index].name === 'lobs'){\n\t\t\t\tfor(var lobIdx=0; lobIdx < allFilters[index].filterOptions.length; lobIdx++){\n\t\t\t\t\tif(allFilters[index].filterOptions[lobIdx].name == lobCd){\n\t\t\t\t\t\treturn allFilters[index].filterOptions[lobIdx].title; \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn lobCd;\n\t};\n\t\n\t//Upload file handler\n\tself.initiateUpload = function(){\n\t\tself.messages.splice(0, self.messages.length);\n\t\tvar accountId = WorkListViewSrv.getParameterByName('WORKITEMID');\n\t\tap.turnstileWidget.launchUploadWidget(accountId);\n\t};\n\t\n\tself.isWorkItemSelected = function(workitem){\n\t\treturn workitem.selected;\n\t};\n\t\n\tself.isLinkedToAccount = function(workitem){\n\t\treturn (typeof workitem.account_id !== 'undefined' && workitem.account_id != -1);\n\t};\n\t\n\t/*\n\t * Service call to get workitem actions\n\t */\n\tself.getWorkItemActions = function(workitem){\n\t\tif(workitem.actions && workitem.actions.length>0){\n\t\t\treturn;\n\t\t}\n\t\tWorkItemActionsSrv.getWorkItemActions(workitem.work_item_id,\n\t\tfunction(res){\n\t\t\tworkitem.actions = res.data.response.results.actions;\n\t\t\t$log.log(\"workitem actions retrieved\");\n\t\t\t$log.log(res);\n\t\t},function(res){\n\t\t\t$log.log(\"Error retrieving workitem actions\");\n\t\t\t$log.log(res);\n\t\t});\n\t};\n\t\n\t/*\n\t * Call back function to be called when a work item tile or row is selected\n\t */\n\tself.itemSelected = function(selectedWorkItem){\n\t\tangular.forEach(self.workListModel.workItems, function(workitem){\n\t\t\tif(workitem.selected == true){\n\t\t\t\tworkitem.selected = false;\n\t\t\t}\n\t\t});\n\t\tselectedWorkItem.selected = true;\n\t\tself.getWorkItemActions(selectedWorkItem);\n\t};\n\t/** \n\t * Return true if index is account.\n\t */\n\tself.isAccountsView = function(){\n\t\treturn angular.equals(self.workListModel.metaData.name, 'AccountsView'); \n\t};\n\t/** \n\t * Return true if workListModel.metaData.name is WorkItemsView.\n\t */\n\tself.isWorkItemsView = function(){\n\t\treturn angular.equals(self.workListModel.metaData.name, 'WorkItemsView'); \n\t};\n\t/** \n\t * Return true if workListModel.metaData.name is AccountItemsView.\n\t */\n\tself.isAccountItemsView = function(){\n\t\treturn angular.equals(self.workListModel.metaData.name, 'AccountItemsView'); \n\t};\n\t\n\t\n\t/*\n\t * Perform the delete workitem/account action.\n\t */\n\tself.deleteWorkItem = function(selectedWorkItem, action){\n\t    var modalInstance = $modal.open({\n\t      templateUrl: 'worklist/partials/modals/workitem-deleteWorkitem.mdl.jsp',\n\t      controller: 'WorkListConfirmationCtrl',\n\t      resolve: {\n\t          details: function () {\n\t        \t  return {workitem: selectedWorkItem, isAccount: self.isAccountsView()};\n\t          }\n\t        }\n\t    });\n\n\t    modalInstance.result.then(function () {\n    \t\tvar plsWaitModal =  $modal.open({\n\t  \t\t      templateUrl: 'worklist/partials/modals/pleasewait.mdl.jsp',\n\t  \t\t      keyboard: false,\n\t  \t\t      backdrop: 'static'\n\t  \t\t    });\t    \t\n\t    \tWorkItemActionsSrv.executeAction(selectedWorkItem,action,\n\t\t\tfunction(response){\n\t    \t\tvar timer = $timeout(function(){\n\t    \t\t\tWorkListViewSrv.getWorkItems(function(data){\n\t    \t\t\t\tplsWaitModal.dismiss('dismiss');\n\t\t\t\t\t});\t\n\t    \t\t},2000);\n\t\t\t\t\n\t\t\t},function(response){\n\t\t\t\t$log.log(\"Failed to complete action of \" + action.code + \" on workitem.\");\n\t\t\t});\n\t\t\t      \n\t    }, function () {\n\t      $log.info('Modal dismissed at: ' + new Date());\n\t    });\n\t};\n\t\n\tself.doApprove = function(selectedWorkItem, action){\n\t\t\n\t    var modalInstance = $modal.open({\n\t      templateUrl: 'worklist/partials/modals/workitem-approveWorkitem.mdl.jsp',\n\t      controller: 'WorkListConfirmationCtrl'\n\t    });\n\n\t    modalInstance.result.then(function () {\n\n\t    \tWorkItemActionsSrv.executeAction(selectedWorkItem,action,\n\t\t\tfunction(response){\n\t\t\t\tWorkListViewSrv.getWorkItems(function(){});\n\t\t\t},function(response){\n\t\t\t\t$log.log(\"Failed to complete action of \" + action.code + \" on workitem.\");\n\t\t\t});\n\t\t\t\t\n\t    }, function () {\n\t      $log.info('Modal dismissed at: ' + new Date());\n\t    });\n\t};\n\n\tself.doLinkToAccount = function(selectedWorkItem, action){\n\t\t\n\t    var modalInstance = $modal.open({\n\t      templateUrl: 'worklist/partials/modals/workitem-linkWorkitem.mdl.jsp',\n\t      controller: 'WorkItemLinkModalCtrl',\n\t      resolve: {\n\t          workitem: function () {\n\t            return selectedWorkItem;\n\t          },\n\t          action: function () {\n\t            return action;\n\t          }\n\t        }\n\t    });\n\t    \n\t    modalInstance.result.then(function (selectedAccount) {\n    \t\tvar plsWaitModal =  $modal.open({\n\t  \t\t      templateUrl: 'worklist/partials/modals/pleasewait.mdl.jsp',\n\t  \t\t      keyboard: false,\n\t  \t\t      backdrop: 'static'\n\t  \t\t    });\t    \t\n\n\t    \taction.url = action.url + '&TARGET_ACCOUNT=' + selectedAccount.work_item_id;\n\t    \tWorkItemActionsSrv.executeAction(selectedWorkItem,action,\n\t\t\tfunction(response){\n\t    \t\t$log.log(\"Workitem linked to account: \" + selectedAccount.work_item_id);\n\t    \t\t$timeout(function(){\n\t    \t\t\tWorkListViewSrv.getWorkItems(function(data){\n\t    \t\t\t\tplsWaitModal.dismiss('dismiss');\n\t\t\t\t\t\tvar successMsgModalInstance = $modal.open({\n\t\t\t\t\t\t      templateUrl: 'worklist/partials/modals/workitem-success.mdl.jsp',\n\t\t\t\t\t\t      controller: 'WorkListSuccessCtrl',\n\t\t\t\t\t\t      resolve: {\n\t\t\t\t\t\t    \t  response: function () {\n\t\t\t\t\t\t            return response.data.response.results;\n\t\t\t\t\t\t          }\n\t\t\t\t\t\t        }\n\t\t\t\t\t\t    });\t    \t\t\t\t\n\t\t\t\t\t});\t\n\t    \t\t},2000);\n\t\t\t},function(response){\n\t\t\t\t$log.log(\"Failed to complete action of \" + action.code + \" on workitem.\");\n\t\t\t});\n\t\t\t\t\n\t    }, function () {\n\t      $log.info('Modal dismissed at: ' + new Date());\n\t    });\n\t};\n\n\tself.doMoveToAccount = function(selectedWorkItem, action){\n\t\t\n\t    var modalInstance = $modal.open({\n\t      templateUrl: 'worklist/partials/modals/workitem-moveWorkitem.mdl.jsp',\n\t      controller: 'WorkItemMoveModalCtrl',\n\t      resolve: {\n\t          workitem: function () {\n\t            return selectedWorkItem;\n\t          }\n\t        }\n\t    });\n\t    \n\t    modalInstance.result.then(function (selectedAccount) {\n    \t\tvar plsWaitModal =  $modal.open({\n\t  \t\t      templateUrl: 'worklist/partials/modals/pleasewait.mdl.jsp',\n\t  \t\t      keyboard: false,\n\t  \t\t      backdrop: 'static'\n\t  \t\t    });\t    \t\n\n\t    \taction.url = action.url + '&TARGET_ACCOUNT=' + selectedAccount.work_item_id;\n\t    \tWorkItemActionsSrv.executeAction(selectedWorkItem,action,\n\t\t\tfunction(response){\n\t    \t\t$log.log(\"Workitem linked to account: \" + selectedAccount.work_item_id);\n\t    \t\tvar timer = $timeout(function(){\n\t    \t\t\tWorkListViewSrv.getWorkItems(function(data){\n\t    \t\t\t\tplsWaitModal.dismiss('dismiss');\n\t\t\t\t\t\t$modal.open({\n\t\t\t\t\t\t      templateUrl: 'worklist/partials/modals/workitem-moveWorkToAccountSuccess.mdl.jsp',\n\t\t\t\t\t\t      controller: 'WorkListSuccessCtrl',\n\t\t\t\t\t\t      resolve: {\n\t\t\t\t\t\t    \t  response: function () {\n\t\t\t\t\t\t            return response.data.response;\n\t\t\t\t\t\t          }\n\t\t\t\t\t\t        }\n\t\t\t\t\t\t    });\t    \t\t\t\t\n\t\t\t\t\t});\t\n\t    \t\t},2000);\n\t\t\t},function(response){\n\t\t\t\t$log.log(\"Failed to complete action of \" + action.code + \" on workitem.\");\n\t\t\t});\n\t\t\t\t\n\t    }, function () {\n\t      $log.info('Modal dismissed at: ' + new Date());\n\t    });\n\t};\n\t\n\tself.pageChanged = function(){\n\t\t$log.log(\"Changing page \" + self.workListModel.pagination.currentPage);\n\t\tangular.forEach(self.workListModel.metaData.listViews,function(view){\n\t\t\tif(view.selected == true){\n\t\t\t\tview.startRowNumber = (self.workListModel.pagination.currentPage * self.workListModel.pagination.fetchSize) - self.workListModel.pagination.fetchSize;\n\t\t\t}\n\t\t});\n\t\tvar currentPage = self.workListModel.pagination.currentPage;\n\t\tWorkListViewSrv.getWorkItems(function(){\n\t\t\tself.workListModel.pagination.currentPage = currentPage;\n\t\t\t$log.log(self.workListModel.pagination);\n\t\t});\n\t};\t\n\t/*\n\t * Call back function called when a action is selected on the title or row\n\t */\n\tself.performAction = function(selectedWorkItem, action){\n\t\tself.messages.splice(0, self.messages.length);\n\t\t$log.log('perform action: ' + action.code);\n\t\tif(action.code == \"Open\" || action.code == 'View') {\n\t\t\twindow.location = action.url + '&' + $.param(csrf);\n\t\t}\n\t\telse if (action.code == 'Endorse') {\n\t\t\twindow.location = action.url + '&TRANSACTION_NAME='+ action.endorseTransactionId + '&' + $.param(csrf);\n\t\t}else if (action.code == 'Copy' || action.code == 'Claim' || action.code == 'Requote' || action.code == 'Withdraw') {\n\t\t\tvar plsWaitModal = $modal.open({\n\t\t\t\ttemplateUrl: 'worklist/partials/modals/pleasewait.mdl.jsp',\n\t\t\t\tkeyboard: false,\n\t\t\t\tbackdrop: 'static'\n\t\t\t});\n\t\t\t\n\t\t\tWorkItemActionsSrv.executeAction(selectedWorkItem,action,\n\t\t\t\t\tfunction(response){\n\t\t\t\t\t\tplsWaitModal.dismiss('dismiss');\t\n\t\t\t\t\t\tif(response.data.response[0].error){\n\t\t\t\t\t\t\t$log.log(\"Failed to complete action of \" + action.code + \" on workitem.\");\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tself.messages.push(response.data.response[0].error);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tvar newWorkItemId = response.data.response[0].newWorkItemId;\n\t\t\t\t\t\t\tvar openMode = response.data.response[0].openMode;\n\t\t\t\t\t\t\tvar openAction = null;\n\t\t\t\t\t\t\tangular.forEach(selectedWorkItem.actions,function(each){\n\t\t\t\t\t\t\t\tif(each.code == 'Open'){\n\t\t\t\t\t\t\t\t\treturn openAction = each;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif(openAction != null){\n\t\t\t\t\t\t\t\tvar openUrl = openAction.url;\n\t\t\t\t\t\t\t\topenUrl = openUrl.replace(selectedWorkItem.work_item_id,newWorkItemId);\n\t\t\t\t\t\t\t\twindow.location = openUrl + \"&openmode=\" + openMode + '&' + $.param(csrf);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t$log.log(\"Unable to launch the newly created workitem: \" + newWorkItemId);\n\t\t\t\t\t\t\t\tself.messages.push(\"Unable to launch the newly created workitem: \" + newWorkItemId);\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},function(response){\n\t\t\t\t\t\t$log.log(\"Failed to complete action of \" + action.code + \" on workitem. Error: \" + response);\n\t\t\t\t\t\tplsWaitModal.dismiss('dismiss');\t\t\n\t\t\t\t\t\tself.messages.push(\"Failed to complete action of \" + action.code + \" on workitem. Error: \" + response);\t\n\t\t\t\t\t});\n\t\t}else if(action.code == 'Delete'){\n\t\t\tself.deleteWorkItem(selectedWorkItem,action);\n\t\t}else if(action.code == 'Link'){\n\t\t\tself.doLinkToAccount(selectedWorkItem,action);\n\t\t}else if(action.code == 'Move'){\n\t\t\tself.doMoveToAccount(selectedWorkItem,action);\n\t\t}else{\n\t\t\tthis.performCustomAction(selectedWorkItem,action);\n\t\t}\n\t\t\n\t};\n\t\n\t\n\tself.performCustomAction = function(selectedWorkItem,action){\n\t\t$log.log(\"You should not be seeing this message in the logs. This method should have been overriden for the custom action :\" + action.code);\n\t};\n\t\n\tself.createWorkItem = function(href){\n\t\tif('upload' === href){\n\t\t\tself.initiateUpload();\n\t\t}else{\n\t\t\tvar plsWaitModal = $modal.open({\n\t\t\t\ttemplateUrl: 'worklist/partials/modals/pleasewait.mdl.jsp',\n\t\t\t\tkeyboard: false,\n\t\t\t\tbackdrop: 'static'\n\t\t\t});\n\n\t\t\tself.messages.splice(0, self.messages.length);\n\t\t\tif(self.isAccountItemsView()) {\n\t\t\t\tvar action = {};\n\t\t\t\taction.url = href;\n\t\t\t\taction.code = \"Copy\";\n\t\t\t\tWorkItemActionsSrv.executeAction({},action, function(response){\n\t\t\t\t\tif(response.data.response[0].error){\n\t\t\t\t\t\t$log.log(\"Failed to complete action of \" + action.code + \" on workitem.\");\n\t\t\t\t\t\tplsWaitModal.dismiss('dismiss');\t\t\t\t\t\t\n\t\t\t\t\t\tself.messages.push(response.data.response[0].error);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tvar url = response.data.response[0].url;\n\t\t\t\t\t\tplsWaitModal.dismiss('dismiss');\n\t\t\t\t\t\twindow.location = url;\n\t\t\t\t\t}\n\t\t\t\t},function(response){\n\t\t\t\t\t$log.log(\"Failed to complete action of \" + action.code + \" on workitem.\");\n\t\t\t\t\tplsWaitModal.dismiss('dismiss');\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\twindow.location = href;\n\t\t\t}\t\t\n\t\t}\n\t};\n\tself.saveSearch = function(responseHandler){\n\t\tWorkListViewSrv.saveSearch(null,function(data){\n\t\t\t$log.log(\"saved search \" + self.savedSearchName);\n\t\t\tself.savedSearchName = \"\"; //reset the name after its been saved.\n\t\t\tif(angular.isFunction(responseHandler)){\n\t\t\t\tresponseHandler(data);\n\t\t\t}\n\t\t});\n\t};\n\t\n\t/*\n\t * These methods are related to tabular view\n\t */\t\n\tself.lookupValue = function(field, workitem){\n\t\tvar val = workitem[field.id];\n\t\tvar newVal = WorkListViewSrv.lookupValue(field.id,val); //lookup using field id\n\t\tif(val == newVal){\n\t\t\tval = WorkListViewSrv.lookupValue(field.type,val); //lookup using field type\n\t\t}else{\n\t\t\tval = newVal;\n\t\t}\n\t\tif(field.format){\n\t\t\ttry{\n\t\t\t\tvar filtersToApply = [];\n\t\t\t\tif(field.format.indexOf('|')){\n\t\t\t\t\tfiltersToApply = field.format.split('|');\n\t\t\t\t}else{\n\t\t\t\t\tfiltersToApply = field.format;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor(var ix=0; ix<filtersToApply.length; ix++){\n\t\t\t\t\tvar formatVal =  filtersToApply[ix];\n\t\t\t\t\tif(formatVal.indexOf(': ')>-1){ //multiple arguments to the filter. e.g. current : '$'\n\t\t\t\t\t\tvar tokens = formatVal.split(': ');\n\t\t\t\t\t\tfor(var i=0; i<tokens.length; i++){ //remove any extra ' character\n\t\t\t\t\t\t\ttokens[i] = tokens[i].replace(/'/g, \"\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tval = $filter(tokens[0].trim())(val, tokens.slice(1));\n\t\t\t\t\t}else{\n\t\t\t\t\t\tval = $filter(formatVal)(val);\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}catch(error){\n\t\t\t\tconsole.log('Unsupported format error: ' + error);\n\t\t\t}\n\t\t}\n\t\treturn val;\n\t};\n\t\n\t/*\n\t * Get the table columns to display based on the listview configuration.\n\t * Make the fields as sortable based on sortinfo configuraiton \n\t */\n\tself.getTableColumns = function(){\n\t\tvar views = self.workListModel.metaData.listViews;\n\t\t\n\t\tfor (var index = 0; index < views.length; ++index) {\n\t\t\tif(views[index].type == 'TABULAR'){\n\t\t\t\tangular.forEach(views[index].fields,function(listField){\n\t\t\t\t\tangular.forEach(self.workListModel.metaData.sortInfo.sortOptions,function(sortField){\n\t\t\t\t\t\tif(sortField.relatedFieldId == listField.id){\n\t\t\t\t\t\t\tlistField.isSortable = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\treturn views[index].fields;\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t};\n\t\n\tself.toggleSort = function(listField){\n\t\tangular.forEach(self.workListModel.metaData.sortInfo.sortOptions,function(sortField){\n\t\t\tif(sortField.relatedFieldId == listField.id){\n\t\t\t\tsortField.selected = true;\n\t\t\t\tsortField.ascending = !sortField.ascending;\n\t\t\t}else{\n\t\t\t\tsortField.ascending = false;\n\t\t\t\tsortField.selected = false;\n\t\t\t}\n\t\t});\n\t\t//Save search criteria and get workitems\n\t\tif(self.workListModel.metaData.isSaveable == true){\n\t\t\tself.workListModel.metaData.savedSearchInfo.currentSearch.id = -1;\n\t\t\tself.workListModel.metaData.savedSearchInfo.currentSearch.name = null;\n\t\t\tself.saveSearch(WorkListViewSrv.getWorkItems);\n\t\t}else{\n\t\t\tWorkListViewSrv.getWorkItems(function(){\n\t\t\t\t$log.log(\"retrieved workitems\");\n\t\t\t});\n\t\t}\n\t\t\n\t};\n\t\t \n\tself.getSortDirection = function(listField){\n\t\tvar className = '';\n\t\tangular.forEach(self.workListModel.metaData.sortInfo.sortOptions,function(sortField){\n\t\t\tif(sortField.relatedFieldId == listField.id){\n\t\t\t\tclassName = sortField.selected?'active':'';\n\t\t\t\tif(sortField.ascending){\n\t\t\t\t\tclassName = className + ' asc';\n\t\t\t\t}else{\n\t\t\t\t\tclassName = className + ' desc';\n\t\t\t\t}\n\n\t\t\t}\n\t\t});\n\t\treturn className;\n\t};\n\t\n\tself.performDoubleClick = function(workitem){\n\t\tif(workitem.actions && workitem.actions.length>0){\n\t\t\tvar openAction = null;\n\t\t\tangular.forEach(workitem.actions,function(each){\n\t\t\t\tif(each.code == 'Open'){\n\t\t\t\t\topenAction = each;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif(openAction != null){\n\t\t\t\twindow.location = openAction.url;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\tself.getWorkItemActions(workitem);\t\t\t\t\t\t\n\t};\n}]);\n\n})();","(function() {\n'use strict';\n\n\tangular.module('ap.worklist.workitemActionsService', ['ap.common.constants'])\n\n\t.service('WorkItemActionsSrv', ['$http', 'contextPath', 'csrf', function($http, contextPath, csrf){\n\t\t\n\t\tvar self = this;\n\t\t\n\t\tself.getWorkItemActions = function(workitemId, successCallBack, errorCallBack){\n\t\t\t return $http.get(\"WorkItemAction?action=GetWorkItemActions\",{\n\t\t\t\t params: angular.extend({WORKITEMID: workitemId},csrf),\n\t\t\t\t headers: { Accept: 'application/json', 'Content-Type': 'application/json'}\n\t\t\t }).then(successCallBack, errorCallBack);\n\t\t};\n\t\t\n\t\tself.executeAction = function(workitem, action, successCallBack, errorCallBack){\n\t\t return $http.get(action.url,{\n\t\t\t params: csrf,\n\t\t\t headers: { Accept: 'application/json', 'Content-Type': 'application/json' }\n\t\t }).then(successCallBack, errorCallBack);\n\t\t};\n\t}]);\n\t\n\t\n})();","(function() {\n\n'use strict';\n\nangular.module('ap.worklist.drv.card', ['ngRoute','ap.common.constants','ap.worklist.workListViewServices'])\n\n\t.directive('workitemCard',\t['$log', 'WorkItemActionsSrv','WorkListViewSrv', function($log, WorkItemActionsSrv, WorkListViewSrv) {\n\t\t$log.log('workitemCard directive!!!');\n\t\treturn {\n\t\t\trestrict : 'A',\n\t\t\tscope : {\n\t\t\t\tworkitemData : '=',\n\t\t\t\ttype: '@',\n\t\t\t\twhenSelected: '&',\n\t\t\t\twhenActionClicked: '&'\n\t\t\t},\n\t\t\tlink : function(scope, element, attrs) {\n\t\t\t\t\n\t\t        scope.contentUrl = 'worklist/partials/' + attrs.type + '-card.tpl.jsp';\n\t\t        scope.actionsOpen = false;\n\t\t        \n\t\t        attrs.$observe(\"type\", function (type) {\n\t\t                $log.log(\"type=\" + type);\n\t\t                scope.contentUrl = 'worklist/partials/' + type + '-card.tpl.jsp';    \n\t\t        });\n\t\t\t\t\n\t\t        /*\n\t\t\t\t * \n\t\t\t\t */\n\t\t\t\tscope.isWorkItemSelected = function(){\n\t\t\t\t\tif( !scope.workitemData.selected ){\n\t\t\t\t\t\tscope.workitemData.selected = false;\n\t\t\t\t\t}\n\t\t\t\t\treturn scope.workitemData.selected;\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tscope.isLinkedToAccount = function(){\n\t\t\t\t\tif( !scope.workitemData.account_id ){\n\t\t\t\t\t\tscope.workitemData.account_id = -1;\n\t\t\t\t\t}\n\t\t\t\t\treturn scope.workitemData.account_id != -1;\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tscope.performDoubleClick = function(){\n\t\t\t\t\tvar workitem = scope.workitemData;\n\t\t\t\t\tif(workitem.actions && workitem.actions.length>0){\n\t\t\t\t\t\tvar openAction = null;\n\t\t\t\t\t\tangular.forEach(workitem.actions,function(each){\n\t\t\t\t\t\t\tif(each.code == 'Open'){\n\t\t\t\t\t\t\t\topenAction = each;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\twindow.location = openAction.url;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tscope.getWorkItemActions(scope.performDoubleClick);\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\t/*\n\t\t\t\t * Service call to get workitem actions\n\t\t\t\t */\n\t\t\t\tscope.getWorkItemActions = function(callbackFunction){\n\t\t\t\t\tvar workitem = scope.workitemData;\n\t\t\t\t\t\n\t\t\t\t\t//Call back parent controller's function\n\t\t\t\t\tscope.whenSelected({\n\t\t\t\t\t\tselectedWorkItem: workitem\n\t\t\t\t\t});\n\n\t\t\t\t\tif(workitem.actions && workitem.actions.length>0){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tWorkItemActionsSrv.getWorkItemActions(workitem.work_item_id,\n\t\t\t\t\tfunction(res){\n\t\t\t\t\t\tworkitem.actions = res.data.response.results.actions;\n\t\t\t\t\t\tif(callbackFunction){\n\t\t\t\t\t\t\tcallbackFunction(workitem.actions);\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$log.log(\"workitem actions retrieved\");\n\t\t\t\t\t},function(res){\n\t\t\t\t\t\t$log.log(\"Error retrieving workitem actions: \" + res);\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tscope.actionClicked = function(action){\n\t\t\t\t\tscope.whenActionClicked({\n\t\t\t\t\t\tselectedWorkItem: scope.workitemData,\n\t\t\t\t\t\taction: action\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tscope.lookupValue = function(key,code){\n\t\t\t\t\treturn WorkListViewSrv.lookupValue(key,code);\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tscope.isWorkItemSubmitted = function(){\n\t\t\t\t\treturn scope.workitemData.external_id  &&  scope.workitemData.external_id > 0;\t\t\t\n\t\t\t\t};\n\t\t\t},\n\t\t\ttemplate : '<div><p ng-include=\"contentUrl\"></p></div>'\n\t\t};\n\t} ]);\n\n})();","(function() {\n\n'use strict';\n\n/*\n * Directive for add new card.\n * This directive is engaged by adding the attribute \"addnew-card\" to any html element.\n * \n * Example\n\t\t<div addnew-card\n\t\t\taddlinks=\"dataCtrl.workListModel.metaData.newWorkItemLinks\"\n\t\t\ttype=\"{{dataCtrl.workListModel.metaData.index}}\"\n\t\t\tname=\"dataCtrl.workListModel.metaData.name\"\n\t\t\twhen-upload=\"dataCtrl.initiateUpload()\"\n\t\t\tcreate-work-item=\"dataCtrl.createWorkItem(href)\">\n\t\t</div>\n * \n * Based on the type argument passed in template 'worklist/partials/' + type + '-addnewcard.tpl.jsp' is engaged\n * \n * dependencies:\n */\nangular.module('ap.worklist.drv.adddNewCard', ['ngRoute'])\n\n\t.directive('addnewCard',\t[ '$log', function($log) {\n\t\t$log.log('addnewCard directive!!!');\n\t\treturn {\n\t\t\trestrict : 'A',\n\t\t\tscope : {\n\t\t\t\taddlinks : '=',\n\t\t\t\ttype: '@',\n\t\t\t\tworkListType: '=name',\n\t\t\t\twhenUpload:'&',\n\t\t\t\tcreateWorkItem: '&'\n\t\t\t},\n\t\t\tlink : function(scope, element, attrs) {\n\t\t\t\t//$log.log(scope, element, attrs);\n\t\t\t\t\n\t\t        scope.contentUrl = 'worklist/partials/worklist-addnewcard.tpl.jsp';\n\t\t        $log.log(\"add new card content url=\" + scope.contentUrl);\n\t\t        scope.addNewState = \"none\";\n\t\t        scope.setState = function(state){\n\t\t        \tscope.addNewState = state;\n\t\t    \t};\t\t        \n\t\t        attrs.$observe(\"type\", function (type) {\n\t                $log.log(\"Add new card in observe=\" + type);\n\t                scope.contentUrl = 'worklist/partials/' + type + '-addnewcard.tpl.jsp';\n\t                $log.log(\"add new card content url=\" + scope.contentUrl);\n\t\t        });\n\t\t\t},\n\t\t\ttemplate : '<div ng-include=\"contentUrl\"></div>'\n\t\t};\n\t} ]);\n\n})();","(function() {\n\n'use strict';\n\nangular.module('ap.worklist.mdl',[])\n\n\t.controller('WorkListConfirmationCtrl', ['$scope', '$modalInstance', '$log', 'details', function ($scope, $modalInstance, $log, details) {\n\t  $scope.details = details;\n\t  $scope.yes = function () {\n\t    $modalInstance.close();\n\t  };\n\n\t  $scope.no = function () {\n\t    $modalInstance.dismiss('cancel');\n\t  };\n\t}])\n\t\n\t/* Link to account modal */\n\t.controller('WorkItemLinkModalCtrl', ['$scope', '$modalInstance', '$log','WorkListViewSrv','WorkItemActionsSrv', 'workitem','action',\n\t                                      \tfunction ($scope, $modalInstance, $log, WorkListViewSrv, WorkItemActionsSrv, workitem, action) {\n\t  $scope.accounts = [];\n\t  $scope.searchVal = \"\";\n\t  $scope.showSearchAccounts = false;\n\t  $scope.displayResults = false;\n\t  \n\t  $scope.select = function (account) {\n\t    $modalInstance.close(account);\n\t  };\n\n\t  $scope.close = function () {\n\t    $modalInstance.dismiss('cancel');\n\t  };\n\t  \n\t  $scope.createNewAccount = function(){\n\t    \taction.url = action.url + '&TARGET_ACCOUNT=-1';\n\t    \tWorkItemActionsSrv.executeAction(workitem,action,function(res){\n\t    \t\tvar url = res.data.response.results.url;\n\t    \t\twindow.location = url;\n\t    \t});\n\t  };\n\t  \n\t  $scope.lookupAccounts = function(){\n\t\t  if($scope.searchVal.length < 3){\n\t\t\t  $scope.accounts =  [];\n\t\t\t  $scope.displayResults = false;\n\t\t\t  return;\n\t\t  }\n\t\t  \n\t\t  WorkListViewSrv.searchEntities('account',$scope.searchVal,null,function(data){\n\t\t\t  $scope.accounts =  data.response.results.docs;\n\t\t\t  $scope.displayResults = true;\n\t\t  });\n\t  };\n\t}])\n\t\n\t/* Move to account modal */\n\t.controller('WorkItemMoveModalCtrl', ['$scope', '$modalInstance', '$log','WorkListViewSrv', 'workitem', function ($scope, $modalInstance, $log, WorkListViewSrv, workitem) {\n\t  $scope.accounts = [];\n\t  $scope.searchVal = \"\";\n\t  $scope.showSearchAccounts = false;\n\t  $scope.displayResults = false;\n\t  \n\t  $scope.select = function (account) {\n\t    $modalInstance.close(account);\n\t  };\n\n\t  $scope.close = function () {\n\t    $modalInstance.dismiss('cancel');\n\t  };\n\t  \n\t  $scope.lookupAccounts = function(){\n\t\t  if($scope.searchVal.length < 3){\n\t\t\t  $scope.accounts =  [];\n\t\t\t  $scope.displayResults = false;\n\t\t\t  return;\n\t\t  }\n\t\t  \n\t\t  WorkListViewSrv.searchEntities('account',$scope.searchVal,workitem.account_id, function(data){\n\t\t\t  $scope.accounts =  data.response.results.docs;\n\t\t\t  $scope.displayResults = true;\n\t\t  });\n\t  };\n\t}])\n\t\n\t/* Success controller */\n\t.controller('WorkListSuccessCtrl', ['$scope', '$modalInstance', '$log', 'response', function ($scope, $modalInstance, $log, response) {\n\t  $scope.response = response;\n\t  $scope.successMessage = ap.htmlDecode(response.message);\n\t  $log.log($scope.successMessage);\n\t  $scope.no = function () {\n\t    $modalInstance.dismiss('cancel');\n\t  };\n\t}])\n\t\n\t/* saved filter delete controller */\n\t.controller('SavedFilterDeleteCtrl', ['$scope', '$modalInstance', '$log', 'savedSearch', 'getMetaData', 'WorkListViewSrv', function ($scope, $modalInstance, $log, savedSearch, getMetaData, WorkListViewSrv) {\n\t\n\t  $scope.savedSearch = savedSearch;\n\t  $scope.getMetaData = getMetaData;\n\t  $scope.WorkListViewSrv = WorkListViewSrv;\n\t  $scope.no = function () {\n\t    $modalInstance.dismiss('cancel');\n\t  };\n\t  \n\t  $scope.yes = function () {\n\t\t  WorkListViewSrv.deleteSearch(savedSearch, getMetaData);\n\t\t  $modalInstance.dismiss('cancel');\n\t  };\n\t}]);\n})();","(function() {\r\n\r\n\t'use strict';\r\n\r\n\tvar workitemAssistantModule = angular.module('workitemAssistantApp', ['angularFileUpload','angularModalService']);\r\n\r\n\t/**\r\n\t * work item assistant controller\r\n\t */\r\n\tworkitemAssistantModule.controller('workitemAssistantCtrl', ['$scope', '$timeout', '$http', 'ModalService', function($scope, $timeout, $http, ModalService) {\t\r\n\r\n\t\t$scope.showWorkitemAssistant = false;\r\n\t\t$scope.comments = {};\r\n\t\t$scope.fileattachments = {};\r\n\t\t$scope.activeusers = '';\r\n\t\t$scope.filetypes = {};\r\n\t\t$scope.editInProgress = false;\r\n\t\t$scope.commentInputs = {};\r\n\r\n\t\t/**\r\n\t\t * pull data from REST\r\n\t\t */\r\n\t\t$scope.update = function () {\r\n\t\t\tif(!$scope.editInProgress){\r\n\t\t\t\t$http.get(\"api/workitemassistants/data?WORKITEMID=\"+ ap.transaction.workItemId, {\r\n\t\t\t\t\theaders: { 'Accept': 'application/json' },\r\n\t\t\t\t\tparams: {CSRF_TOKEN: ap.page.csrfToken,transaction_id: ap.transaction.id, rnd: new Date().getTime()}}\r\n\t\t\t\t).success(function(data){\r\n\t\t\t\t\tvar results = data.response.results.workItemAssistant;\r\n\t\t\t\t\t$scope.updateData(results);\r\n\t\t\t\t})\r\n\t\t\t\t.error(function(data,status, headers){\r\n\t\t\t\t\tap.consoleInfo(\"WIA is not supported\");\r\n\t\t\t\t\t$scope.showWorkitemAssistant = false;\r\n\t\t\t\t});\t\t\t\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * update the data\r\n\t\t * @param results the data from REST\r\n\t\t */\r\n\t\t$scope.updateData = function(results){\r\n\t\t\tvar comments = [];\t\t\r\n\t\t\tif(results.comments){\r\n\t\t\t\t$.each(results.comments, function(i, entry) {\r\n\t\t\t\t\tcomments[entry.id] = $(\"#comments_text\" + entry.id).val();\r\n\t\t\t\t});\r\n\t\t\t\t$scope.comments = results.comments;\r\n\t\t\t}\r\n\r\n\t\t\tif(results.fileattachments){\r\n\t\t\t\t$scope.fileattachments = results.fileattachments;\r\n\t\t\t\t$scope.filetypes = $scope.fileattachments[0].fileTypes;\r\n\t\t\t}\r\n\t\t\tif(results.activeusers){\r\n\t\t\t\t$scope.activeusers =  results.activeusers;\r\n\t\t\t}\r\n\t\t\t$scope.showWorkitemAssistant = true;\r\n\r\n\t\t\tfor (var key in comments) {\r\n\t\t\t\t$(\"#comments_text\" + key).val(comments[key]);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t$scope.update();\r\n\t\tvar poll = function() {\r\n\t\t\tif($scope.showWorkitemAssistant){\r\n\t\t\t\t$timeout(function() {\r\n\t\t\t\t\t$scope.update();\r\n\t\t\t\t\tif($scope.showWorkitemAssistant){\r\n\t\t\t\t\t\tpoll();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, ap.page.clientUpdateInterval * 1000);\r\n\t\t\t}\r\n\t\t};     \r\n\t\tpoll();\r\n\r\n\t\t/**\r\n\t\t * check if the comment input is empty\r\n\t\t * @param section the section object\r\n\t\t */\r\n\t\t$scope.commentsEmpty= function (section){\r\n\t\t\tvar val = $scope.commentInputs[section.id];\t\t\r\n\t\t\treturn (null == val || val  == ''); \r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * add comment\r\n\t\t * \"pages/{\" + PAGE_ID + \"}/sections/{\"  + SECTION_ID  +  \"}/comments\"\r\n\t\t * @param section the section object\r\n\t\t */\r\n\t\t$scope.addComment = function(section){\r\n\t\t\tvar data = { commentText: $scope.commentInputs[section.id]};\r\n\t\t\t\r\n\t\t\tvar url = $scope.getBaseUri(section.id) + \"comments/contents?\" + $scope.getCommonUrlParams();\r\n\t\t\t$scope.service(url, 'POST', data, function(results){\r\n\t\t\t\t$scope.update();\r\n\t\t\t\t$scope.commentInputs[section.id] = '';\r\n\t\t\t}, null);\t\t\t\r\n\r\n\t\t};\r\n\r\n\r\n\t\t/**\r\n\t\t * delete an entry\r\n\t\t * @param entry the comment or file attachment entry\r\n\t\t * @param section the section object\r\n\t\t */\r\n\t\t$scope.deleteEntry = function(entry, section){\t\r\n\t\t\t$scope.editInProgress = true;\r\n\t\t\tvar template = 'deleteCommentConfirmModal.html';\r\n\t\t\tif(section.type == 'fileAttachments'){\r\n\t\t\t\ttemplate = 'deleteFileConfirmModal.html';\r\n\t\t\t}\r\n\t\t\tModalService.showModal({\r\n\t\t\t\ttemplateUrl: template,\r\n\t\t\t\tcontroller: \"deleteModalCtrl\",\r\n\t\t\t\tinputs: { entryId: entry.id, sectionType: section.type, sectionId:  section.id}\r\n\t\t\t}).then(function(modal) {\r\n\t\t\t\tmodal.element.modal();\r\n\t\t\t\tmodal.close.then(function(result) {\r\n\t\t\t\t\t$scope.editInProgress = false;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t};\r\n\r\n\r\n\t\t/**\r\n\t\t * edit an entry (for file name only)\r\n\t\t * @param entry the file attachment entry\r\n\t\t */\r\n\t\t$scope.editEntry = function(entry, section){\t\r\n\t\t\t$scope.editInProgress = true;\r\n\t\t\tModalService.showModal({\r\n\t\t\t\ttemplateUrl: 'fileNameModal.html',\r\n\t\t\t\tcontroller: \"fileNameModalCtrl\",\r\n\t\t\t\tinputs: { entryId: entry.id, sectionId: section.id }\r\n\t\t\t}).then(function(modal) {\r\n\t\t\t\tmodal.element.modal();\r\n\t\t\t\tmodal.close.then(function(result) {\r\n\t\t\t\t\t$scope.editInProgress = false;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * send request over\r\n\t\t * @param url  the request url\r\n\t\t * @param method the request method\r\n\t\t * @param data the post form data\r\n\t\t * @param callback the call back for a successful request\r\n\t\t * @param error_callback the call back with error\r\n\t\t */\r\n\t\t$scope.service = function(url, method, data, callback, error_callback){\r\n\t\t\tvar params = {\r\n\t\t\t\t\turl: url,\r\n\t\t\t\t\ttype: method,\r\n\t\t\t\t\tdataType : \"json\",\r\n\t\t\t\t\theaders: { Accept: 'application/json' },\r\n\t\t\t\t\tsuccess:(function(response) {\r\n\t\t\t\t\t\tif(callback){ callback.call(this, response.response.results);}\r\n\t\t\t\t\t}),\r\n\t\t\t\t\terror:(function(response){\r\n\t\t\t\t\t\tif(error_callback){error_callback.call(this, response);}\r\n\t\t\t\t\t})\r\n\t\t\t};\r\n\t\t\tif(data){ params['data'] = data;}\r\n\t\t\t$.ajax(params);\r\n\t\t};\r\n\t\t\r\n\t\t/**\r\n\t\t * return base uri\r\n\t\t * @param sectionId the section id\r\n\t\t */\r\n\t\t$scope.getBaseUri = function(sectionId){\r\n\t\t\tvar url = \"api/workitemassistants/pages/\" + ap.page.id +  \"/sections/\" + sectionId +  \"/\";\r\n\t\t\treturn url;\r\n\t\t};\r\n\t\t\r\n\t\t/**\r\n\t\t * return the commom url parameters\r\n\t\t * \r\n\t\t */\r\n\t\t$scope.getCommonUrlParams = function(){\r\n\t\t\tvar params = \t$.param({\"CSRF_TOKEN\": ap.page.csrfToken, \"WORKITEMID\" : ap.transaction.workItemId, \"transaction_id\": ap.transaction.id});\r\n\t\t\treturn params;\r\n\t\t};\r\n\t\t\r\n\t}]);\r\n\r\n\t/**\r\n\t * file upload controller\r\n\t */\r\n\tworkitemAssistantModule.controller('workitemAssistantUploadCtrl', ['$scope','FileUploader', function($scope, FileUploader){\t\r\n\t\t$scope.fileTypeCode = '';\t    \r\n\t\tvar uploader = $scope.uploader = new FileUploader({\r\n\t\t\turl: 'FrontServlet',\r\n\t\t\tremoveAfterUpload:true,\r\n\t\t\tqueueLimit:  1,\r\n\t\t\tautoUpload: false \r\n\t\t});\r\n\r\n\t\tuploader._addToQueue = uploader.addToQueue;\r\n\t\t\r\n\t\tuploader.onBeforeUploadItem = function(item) {\r\n\t\t\titem.formData.push({\r\n\t\t\t\tCSRF_TOKEN: ap.page.csrfToken,\r\n\t\t\t\tWORKITEMID: ap.transaction.workItemId,\r\n\t\t\t\tPAGE_NAME: ap.page.id,\r\n\t\t\t\tTRANSACTION_NAME: ap.transaction.id,\r\n\t\t\t\tMETHOD:'Process',\r\n\t\t\t\tNEXT: 'WorkItemAssistant',\r\n\t\t\t\tACTION:'FileAttachmentAdd',\r\n\t\t\t\tSECTION: $scope.fileattachments[0].id,\r\n\t\t\t\tFILE_TYPE: $scope.fileTypeCode\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t$(\"#wia_filesize_error_msg\").hide();\r\n\t\t\t$(\"#wia_filevalidation_error_msg\").hide();\r\n\t\t};\r\n\r\n\t\tuploader.onCompleteItem = function(item, response, status, headers) {\r\n\t\t\tif (response && response.response && response.response.status && response.response.status == -119) {\r\n\t\t\t\t$(\"#wia_filesize_error_msg\").show();\r\n\t\t\t}\r\n\t\t\telse if (response && response.response && response.response.status && response.response.status == -120) {\r\n\t\t\t\t$(\"#wia_filevalidation_error_msg\").show();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t$scope.update();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tuploader.clearQueue();\r\n\t\t};\r\n\t\t\r\n\t\tuploader.hasFileCodeSelected = function() {\t\t\t\r\n\t\t\treturn ($(\"#fileTypeCode\").val() != '');\r\n\t\t};\r\n\r\n\t\tuploader.showQueue = function(){\r\n\t\t\tif(uploader.isHTML5){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\t\t};\r\n\r\n\t\tuploader.showAction = function(){\r\n\t\t\treturn false;\r\n\t\t};\r\n\t\t\r\n\t\tuploader.sendAll = function(){\r\n\t\t\tif(!uploader.hasFileCodeSelected() || uploader.getNotUploadedItems().length == 0 ){\r\n\t\t\t\t$(\"#wia_error_msg\").show();\r\n\t\t\t\t$(\"#wia_filesize_error_msg\").hide();\r\n\t\t\t\t$(\"#wia_filevalidation_error_msg\").hide();\r\n\t\t\t}else{\r\n\t\t\t\tuploader.uploadAll();\r\n\t\t\t\t$(\"#wia_error_msg\").hide();\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tuploader.clearAll = function(){\r\n\t\t\tuploader.clearQueue();\r\n\t\t\t$(\"#wia_error_msg\").hide();\r\n\t\t\t$(\"#wia_filesize_error_msg\").hide();\r\n\t\t\t$(\"#wia_filevalidation_error_msg\").hide();\r\n\t\t};\r\n\t\t\r\n\t\t/**\r\n\t\t * add file to queue. if the queue is full,  remove the first one\r\n\t\t */\r\n\t\tuploader.addToQueue = function(files, options, filters) {\r\n\t\t\t$scope.fileTypeCode = $(\"#fileTypeCode\").val();\r\n\t\t\t if(uploader.queue.length == uploader.queueLimit){\r\n\t\t\t\t var item = uploader.queue[0];\r\n\t             if (item.isUploading){\r\n\t            \t item.cancel();\r\n\t             }\r\n\t             uploader.queue.splice(0, 1);\r\n\t             item._destroy();\r\n\t             uploader.progress = uploader._getTotalProgress();\r\n\t\t\t }\r\n\t\t\t uploader._addToQueue(files, options, filters);\r\n\t\t\t $(\"#fileTypeCode\").val($scope.fileTypeCode);\r\n\t\t\t $(\"#wia_filesize_error_msg\").hide();\r\n\t\t\t $(\"#wia_filevalidation_error_msg\").hide();\r\n         };\r\n\t}]);\r\n\r\n\t/**\r\n\t * upload file rename controller\r\n\t */\r\n\tworkitemAssistantModule.controller('fileNameModalCtrl', function($scope, entryId, sectionId, close) {\r\n\t\t$scope.filename = '';\t\t\r\n\t\t$scope.filenNameEmpty = function(){\r\n\t\t\treturn ($scope.filename == '');\r\n\t\t};\r\n\r\n\t\t$scope.close = function(arg) {\r\n\t\t\tif(arg == 'save' && $scope.filename != ''){\r\n\t\t\t\tvar scope = angular.element($(\"#work_item_assistant_group\")).scope();\r\n\t\t\t\tvar url = scope.getBaseUri(sectionId) +  \"fileattachments/filenames?\" +  scope.getCommonUrlParams() +\"&\" +\r\n\t\t\t\t\t$.param({\"file_name\":$scope.filename, \"WI_ASSISTANT_ID\": entryId});\r\n\t\t\t\tscope.service(url, 'PUT', null, function(results){\r\n\t\t\t\t\tscope.editInProgress = false;\r\n\t\t\t\t\tscope.update();\r\n\t\t\t\t\tap.consoleInfo(\"File name has been upated.\");\r\n\t\t\t\t}, null);\r\n\t\t\t}\r\n\t\t\tclose('', 300);\r\n\t\t};\r\n\t});\r\n\r\n\t/**\r\n\t * comments or file deletion controller\r\n\t */\r\n\tworkitemAssistantModule.controller('deleteModalCtrl', function($scope, entryId, sectionType, sectionId, close) {\t\r\n\t\t$scope.close = function(arg) {\r\n\t\t\tif(arg == 'delete'){\r\n\t\t\t\tvar scope = angular.element($(\"#work_item_assistant_group\")).scope();\r\n\t\t\t\tvar url = scope.getBaseUri(sectionId);\r\n\t\t\t\tif(sectionType == 'fileAttachments'){\r\n\t\t\t\t\turl +=  \"fileattachments?\" + scope.getCommonUrlParams() + \"&\" +  $.param({\"WI_ASSISTANT_ID\": entryId});\r\n\t\t\t\t}else{\r\n\t\t\t\t\turl +=  \"comments?\" + scope.getCommonUrlParams() + \"&\"+  $.param({\"commentId\": entryId});\t\r\n\t\t\t\t}\r\n\t\t\t\tscope.service(url, 'DELETE', null, function(results){\r\n\t\t\t\t\tscope.editInProgress = false;\r\n\t\t\t\t\tscope.update();\r\n\t\t\t\t\tap.consoleInfo(\"Entry has been deleted.\");\r\n\t\t\t\t}, null);\r\n\t\t\t}\r\n\t\t\tclose('', 300);\r\n\t\t};\r\n\t});\r\n\r\n})();\r\n","(function (angular) {\n\n'use strict';\n\nangular.module('ap.worklist.queues', ['ngResource', 'ngRoute', 'ui.bootstrap', 'ap.common.constants','ap.worklist.workListViewServices'])\n\n/*\n * ap.worklist.worklistViewCtrl is first controller that paints the worklist.\n * It initiates query for worklist meta data\n * Paints the worklist search options\n */\n.controller('ap.worklist.recentWorkItemsQueueCtrl', ['$resource', '$filter', 'csrfObject','contextPath','WorkListViewSrv', '$log',\n                    function($resource, $filter, csrfObject, contextPath, WorkListViewSrv, $log) {\n\t$log.log('created ap.worklist.recentWorkItemsQueueCtrl');\n\tvar self = this;\n\tself.agentqueue = {};\n\tself.uwqueue ={};\t\n\tself.quoteBoxes = {};\n\t\n\tself.agentqueue.metaData = {};\n\tself.agentqueue.workItems = {};\n\tself.agentqueue.fetchWorkItem=true;\n\n\tself.uwqueue.metaData = {};\n\tself.uwqueue.workItems = {};\n\tself.uwqueue.fetchWorkItem=true;\n\n\tself.quoteBoxes.metaData = {};\n\tself.quoteBoxes.fetchWorkItem = false;\n\t\n\t\n\tself.agentqueue.worklistResource = \n\t\t $resource(contextPath + '/api/worklists/workitems/views/WorkItemsRecentAgentQueue?:csrftokenname=:csrftoken' , {},{\n\t\t\tquery: {method:'GET', params: {csrftokenname: '@csrftokenname', csrftoken: '@csrftoken'}, isArray:false, headers: { Accept: 'application/json' } },\n\t\t\tread: {method:'POST', params: {csrftokenname: '@csrftokenname', csrftoken: '@csrftoken'}, isArray:false, headers: { Accept: 'application/json', 'Content-Type': 'application/json' }}\n\t\t});\n\n\tself.uwqueue.worklistResource = \n\t\t $resource(contextPath + '/api/worklists/workitems/views/WorkItemsRecentUWQueue?:csrftokenname=:csrftoken' , {},{\n\t\t\tquery: {method:'GET', params: {csrftokenname: '@csrftokenname', csrftoken: '@csrftoken'}, isArray:false, headers: { Accept: 'application/json' } },\n\t\t\tread: {method:'POST', params: {csrftokenname: '@csrftokenname', csrftoken: '@csrftoken'}, isArray:false, headers: { Accept: 'application/json', 'Content-Type': 'application/json' }}\n\t\t});\n\n\tself.quoteBoxes.worklistResource = \n\t\t $resource(contextPath + '/api/worklists/workitems/views/QuotesByStatus?:csrftokenname=:csrftoken' , {},{\n\t\t\tquery: {method:'GET', params: {csrftokenname: '@csrftokenname', csrftoken: '@csrftoken'}, isArray:false, headers: { Accept: 'application/json' } },\n\t\t\tread: {method:'POST', params: {csrftokenname: '@csrftokenname', csrftoken: '@csrftoken'}, isArray:false, headers: { Accept: 'application/json', 'Content-Type': 'application/json' }}\n\t\t});\n\t\n\t//This function is called after the initial meta for worklist is retrieved\n\t//initView will setup any state default values for painting the UI\n\tself.initView = function(queue){\n\t\t$log.log(queue.metaData);\n\t\tWorkListViewSrv.retrieveLookupList(queue.metaData.lookupLinks,{worklistType: 'workitems'});\n\t\t\n\t\tif(queue.fetchWorkItem){\n\t\t\tself.fetchWorkItems(queue);\n\t\t}\n\t};\n\t\n\tself.getItemCount = function(status){\n\t\tfor(var index in self.quoteBoxes.statuses){\n\t\t\tif(self.quoteBoxes.statuses[index] == status){\n\t\t\t\treturn self.quoteBoxes.items[index];\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t};\n\t\n\tself.fetchWorkItems = function(queue,resHandler){\n\t\tvar par = angular.extend({csrftokenname: csrfObject.csrftokenName, csrftoken: csrfObject.csrftokenValue},queue.metaData);\n\t\t\tqueue.worklistResource.read(par,function(data,headers){\n\t\t\t queue.workItems = data.response.results.docs;\n\t\t\t if(angular.isFunction(resHandler)){\n\t\t\t\t resHandler(data.response); \n\t\t\t }\n\t\t },function(data){\n\t\t\t $log.log(data);\n\t\t});\n\t};\n\t\n\tself.getMetaData = function(queue,resHandler){\n\n\t\tqueue.worklistResource.query({csrftokenname: csrfObject.csrftokenName, csrftoken: csrfObject.csrftokenValue},function(data,headers){\n\t\t\tqueue.metaData = data.response.results.workListView;\n\t\t\t \n\t\t\t self.initView(queue);\n\t\t\t \n\t\t\t if(angular.isFunction(resHandler)){\n\t\t\t\t resHandler();\n\t\t\t }\n\t\t\t},function(data){\n\t\t\t$log.log('Unable to retrieve valid meta data for worklist : ' + data);\n\t\t});\n\n\t};\n\t\n\tself.getMetaData(self.agentqueue,function(){\n\t\tself.getMetaData(self.uwqueue,function(){\n\t\t\tself.getMetaData(self.quoteBoxes,function(){\n\t\t\t\t$log.log(self.quoteBoxes);\n\t\t\t\tself.getQuoteGroups(self.quoteBoxes);\n\t\t\t});\n\t\t});\n\t});\n\t\n\n\tself.lookupValue = function(key,code){\n\t\treturn WorkListViewSrv.lookupValue(key,code);\n\t};\n\t\n\tself.getDaysFromToday = function(lastUpdated){\n\t\tvar  nowTime = (new Date()).getTime();\n\t\tvar index = lastUpdated.indexOf(' ');\t\t\n\t\tvar pattern = /(\\d{2})\\-(\\d{2})\\-(\\d{4})/;\n\t\tvar dt =  lastUpdated.substring(0, index).replace(pattern,'$3/$1/$2');\n\t\t\n\t\tlastUpdated = dt +  lastUpdated.substring(index);\n\t\t\n\t\tvar lastDatetime = (new Date(lastUpdated)).getTime();\n\t\tvar diff = nowTime - lastDatetime;\n\t\tvar secs = Math.abs(diff)/1000;\n\t\treturn Math.round(secs/(60*60*24));\n\t};\n\t\n\tself.getQuoteGroups = function(quene){\n\t\t\n\t\tquene.statuses = [];\n\t\tquene.items = [];\n\t\tquene.params = [];\n\t\tvar  keepGoing = true;\n\t\tangular.forEach(quene.metaData.queryInfo.queryFields,function(queryField){\t\t\t\n\t\t\tif(queryField.dataType=='STATUS' && keepGoing){\n\t\t\t\tkeepGoing = false;\n\t\t\t\tquene.statuses = angular.copy(queryField.operands);\t\t\t\t\n\t\t\t\tfor(var index in quene.statuses){\t\t\t\n\t\t\t\t\tvar status = quene.statuses[index];\n\t\t\t\t\tqueryField.operands= [status];\n\t\t\t\t\tvar par = angular.extend({csrftokenname: csrfObject.csrftokenName, csrftoken: csrfObject.csrftokenValue}, quene.metaData);\n\t\t\t\t\tquene.params[index] =  angular.copy(par);\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\n\t\tself.getQuoteCount(quene, 0);\n\t\t$log.log(self.quoteBoxes);\n\t};\n\t\n\t//get count by status using $resource chain.\n\tself.getQuoteCount =  function (quene, index){\n\t\tif(index < quene.statuses.length){\n\t\t\tquene.worklistResource.read(quene.params[index],function(data,headers){\n\t\t\t\tquene.items[index] = data.response.results.hits;\n\t\t\t\tself.getQuoteCount(quene, index + 1);\n\t\t\t},function(data){\n\t\t\t\t$log.log(data);\n\t\t\t});\n\t\t}else{\n\t\t\tquene.params = [];\n\t\t}\n\t};\n\t\n\tself.getWorkItemValue = function(field, workitem){\n\t\tvar val = workitem[field.id];\n\t\tif(field.id == 'last_update_time'){\n\t\t\tval = self.getDaysFromToday(workitem.last_update_time);\n\t\t}else{\n\t\t\tvar newVal = self.lookupValue(field.id,val); //lookup using field id\n\t\t\tif(val == newVal){\n\t\t\t\tval = self.lookupValue(field.type,val); //lookup using field type\n\t\t\t}else{\n\t\t\t\tval = newVal;\n\t\t\t}\n\t\t\tif(field.format){\n\t\t\t\ttry{\n\t\t\t\t\tvar filtersToApply = [];\n\t\t\t\t\tif(field.format.indexOf('|')){\n\t\t\t\t\t\tfiltersToApply = field.format.split('|');\n\t\t\t\t\t}else{\n\t\t\t\t\t\tfiltersToApply = field.format;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tfor(var ix=0; ix<filtersToApply.length; ix++){\n\t\t\t\t\t\tvar formatVal =  filtersToApply[ix];\n\t\t\t\t\t\tif(formatVal.indexOf(': ')>-1){ //multiple arguments to the filter. e.g. current : '$'\n\t\t\t\t\t\t\tvar tokens = formatVal.split(': ');\n\t\t\t\t\t\t\tfor(var i=0; i<tokens.length; i++){ //remove any extra ' character\n\t\t\t\t\t\t\t\ttokens[i] = tokens[i].replace(/'/g, \"\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tval = $filter(tokens[0])(val, tokens.slice(1));\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tval = $filter(formatVal)(val);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}catch(error){\n\t\t\t\t\tconsole.log('Unsupported format error: ' + error);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn val;\n\t\t}\n\t\treturn val;\n\t\t\n\t};\n}]);\n\n})(window.angular);"]}